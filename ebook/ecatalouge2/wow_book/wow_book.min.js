
(function(e) {
    if (!e.browser) {
        var r;
        r = navigator.userAgent || "";
        e.uaMatch = function(e) {
            e = e.toLowerCase();
            e = /(chrome)[ \/]([\w.]+)/.exec(e) || /(webkit)[ \/]([\w.]+)/.exec(e) || /(opera)(?:.*version)?[ \/]([\w.]+)/.exec(e) || /(msie) ([\w.]+)/.exec(e) || 0 > e.indexOf("compatible") && /(mozilla)(?:.*? rv:([\w.]+))?/.exec(e) || [];
            return {
                browser: e[1] || "",
                version: e[2] || "0"
            }
        };
        r = e.uaMatch(r);
        e.browser = {};
        r.browser && (e.browser[r.browser] = !0, e.browser.version = r.version);
        e.browser.webkit && (e.browser.safari = !0)
    }
})(jQuery);
jQuery.easing.jswing = jQuery.easing.swing;
jQuery.extend(jQuery.easing, {
    easeOutCubic: function(e, r, v, t, n) {
        return t * ((r = r / n - 1) * r * r + 1) + v
    },
    easeOutExpo: function(e, r, v, t, n) {
        return r == n ? v + t : t * (-Math.pow(2, -10 * r / n) + 1) + v
    }
});
window.Modernizr = function(e, r, v) {
    function t(a, b) {
        for (var c in a)
            if (B[a[c]] !== v) return "pfx" == b ? a[c] : !0;
        return !1
    }

    function n(a, b, c) {
        var d = a.charAt(0).toUpperCase() + a.substr(1),
            f = (a + " " + A.join(d + " ") + d).split(" ");
        if ("string" === typeof b || "undefined" === typeof b) b = t(f, b);
        else a: {
            f = (a + " " + F.join(d + " ") + d).split(" "), a = f;
            for (var e in a)
                if (d = b[a[e]], d !== v) {
                    b = !1 === c ? a[e] : "function" === typeof d ? d.bind(c || b) : d;
                    break a
                }
            b = !1
        }
        return b
    }
    var k = {},
        p = r.documentElement,
        m = r.createElement("modernizr"),
        B = m.style;
    e = " -webkit- -moz- -o- -ms- ".split(" ");
    var A = ["Webkit", "Moz", "O", "ms"],
        F = ["webkit", "moz", "o", "ms"],
        m = {},
        D = [],
        a = D.slice,
        b, c = function(a, b, c, d) {
            var f, e, g, k = r.createElement("div"),
                n = r.body,
                m = n ? n : r.createElement("body");
            if (parseInt(c, 10))
                for (; c--;) g = r.createElement("div"), g.id = d ? d[c] : "modernizr" + (c + 1), k.appendChild(g);
            return f = ["&#173;<style>", a, "</style>"].join(""), k.id = "modernizr", (n ? k : m).innerHTML += f, m.appendChild(k), n || (m.style.background = "", p.appendChild(m)), e = b(k, a), n ? k.parentNode.removeChild(k) : m.parentNode.removeChild(m), !!e
        },
        d = {}.hasOwnProperty,
        f;
    "undefined" === typeof d || "undefined" === typeof d.call ? f = function(a, b) {
        return b in a && "undefined" === typeof a.constructor.prototype[b]
    } : f = function(a, b) {
        return d.call(a, b)
    };
    Function.prototype.bind || (Function.prototype.bind = function(b) {
        var c = this;
        if ("function" != typeof c) throw new TypeError;
        var d = a.call(arguments, 1),
            f = function() {
                if (this instanceof f) {
                    var e = function() {};
                    e.prototype = c.prototype;
                    var e = new e,
                        g = c.apply(e, d.concat(a.call(arguments)));
                    return Object(g) === g ? g : e
                }
                return c.apply(b, d.concat(a.call(arguments)))
            };
        return f
    });
    (function(a, b) {
        var d = a.join(""),
            f = b.length;
        c(d, function(a, b) {
            for (var c = a.childNodes, d = {}; f--;) d[c[f].id] = c[f];
            k.csstransforms3d = 9 === (d.csstransforms3d && d.csstransforms3d.offsetLeft) && 3 === d.csstransforms3d.offsetHeight
        }, f, b)
    })([, ["@media (", e.join("transform-3d),("), "modernizr){#csstransforms3d{left:9px;position:absolute;height:3px;}}"].join("")], [, "csstransforms3d"]);
    m.csstransforms3d = function() {
        var a = !!n("perspective");
        return a && "webkitPerspective" in p.style && (a = k.csstransforms3d), a
    };
    for (var g in m) f(m, g) && (b = g.toLowerCase(), k[b] = m[g](), D.push((k[b] ? "" : "no-") + b));
    B.cssText = "";
    return m = null, k._version = "2.5.3", k._prefixes = e, k._domPrefixes = F, k._cssomPrefixes = A, k.testProp = function(a) {
        return t([a])
    }, k.testAllProps = n, k.testStyles = c, k.prefixed = function(a, b, c) {
        return b ? n(a, b, c) : n(a, "pfx")
    }, k
}(this, this.document);
(function(e, r, v) {
    function t(e) {
        e = e || location.href;
        return "#" + e.replace(/^[^#]*#?(.*)$/, "$1")
    }
    "$:nomunge";
    var n = document,
        k, p = e.event.special,
        m = n.documentMode,
        B = "onhashchange" in r && (m === v || 7 < m);
    e.fn.hashchange = function(e) {
        return e ? this.bind("hashchange", e) : this.trigger("hashchange")
    };
    e.fn.hashchange.delay = 50;
    p.hashchange = e.extend(p.hashchange, {
        setup: function() {
            if (B) return !1;
            e(k.start)
        },
        teardown: function() {
            if (B) return !1;
            e(k.stop)
        }
    });
    k = function() {
        function k() {
            var b = t(),
                g = d(a);
            b !== a ? (c(a = b, g), e(r).trigger("hashchange")) :
                g !== a && (location.href = location.href.replace(/#.*/, "") + g);
            p = setTimeout(k, e.fn.hashchange.delay)
        }
        var m = {},
            p, a = t(),
            b = function(a) {
                return a
            },
            c = b,
            d = b;
        m.start = function() {
            p || k()
        };
        m.stop = function() {
            p && clearTimeout(p);
            p = v
        };
        e.browser.msie && !B && function() {
            var a, g;
            m.start = function() {
                a || (g = (g = e.fn.hashchange.src) && g + t(), a = e('<iframe tabindex="-1" title="empty"/>').hide().one("load", function() {
                    g || c(t());
                    k()
                }).attr("src", g || "javascript:0").insertAfter("body")[0].contentWindow, n.onpropertychange = function() {
                    try {
                        "title" ===
                        event.propertyName && (a.document.title = n.title)
                    } catch (b) {}
                })
            };
            m.stop = b;
            d = function() {
                return t(a.location.href)
            };
            // c = function(b, c) {
            //     var d = a.document,
            //         g = e.fn.hashchange.domain;
            //     b !== c && (d.title = n.title, d.open(), g && d.write('<script>document.domain="' + g + '"\x3c/script>'), d.close(), a.location.hash = b)
            // }
        }();
        return m
    }()
})(jQuery, this);
try {
    (function(e, r, v, t) {
        function n(a, b, c) {
            return setTimeout(F(a, c), b)
        }

        function k(a, b, c) {
            return Array.isArray(a) ? (p(a, c[b], c), !0) : !1
        }

        function p(a, b, c) {
            var d;
            if (a)
                if (a.forEach) a.forEach(b, c);
                else if (a.length !== t)
                for (d = 0; d < a.length;) b.call(c, a[d], d, a), d++;
            else
                for (d in a) a.hasOwnProperty(d) && b.call(c, a[d], d, a)
        }

        function m(a, b, c) {
            for (var d = Object.keys(b), e = 0; e < d.length;) {
                if (!c || c && a[d[e]] === t) a[d[e]] = b[d[e]];
                e++
            }
            return a
        }

        function B(a, b) {
            return m(a, b, !0)
        }

        function A(a, b, c) {
            b = b.prototype;
            var d;
            d = a.prototype =
                Object.create(b);
            d.constructor = a;
            d._super = b;
            c && m(d, c)
        }

        function F(a, b) {
            return function() {
                return a.apply(b, arguments)
            }
        }

        function D(a, b) {
            return "function" == typeof a ? a.apply(b ? b[0] || t : t, b) : a
        }

        function a(a, b, c) {
            p(d(b), function(b) {
                a.addEventListener(b, c, !1)
            })
        }

        function b(a, b, c) {
            p(d(b), function(b) {
                a.removeEventListener(b, c, !1)
            })
        }

        function c(a, b) {
            for (; a;) {
                if (a == b) return !0;
                a = a.parentNode
            }
            return !1
        }

        function d(a) {
            return a.trim().split(/\s+/g)
        }

        function f(a, b, c) {
            if (a.indexOf && !c) return a.indexOf(b);
            for (var d = 0; d < a.length;) {
                if (c &&
                    a[d][c] == b || !c && a[d] === b) return d;
                d++
            }
            return -1
        }

        function g(a) {
            return Array.prototype.slice.call(a, 0)
        }

        function h(a, b, c) {
            for (var d = [], e = [], g = 0; g < a.length;) {
                var h = b ? a[g][b] : a[g];
                0 > f(e, h) && d.push(a[g]);
                e[g] = h;
                g++
            }
            c && (d = b ? d.sort(function(a, c) {
                return a[b] > c[b]
            }) : d.sort());
            return d
        }

        function l(a, b) {
            for (var c, d = b[0].toUpperCase() + b.slice(1), e = 0; e < da.length;) {
                c = (c = da[e]) ? c + d : b;
                if (c in a) return c;
                e++
            }
            return t
        }

        function q(a) {
            a = a.ownerDocument || a;
            return a.defaultView || a.parentWindow || e
        }

        function z(a, b) {
            var c = this;
            this.manager = a;
            this.callback = b;
            this.element = a.element;
            this.target = a.options.inputTarget;
            this.domHandler = function(b) {
                D(a.options.enable, [a]) && c.handler(b)
            };
            this.init()
        }

        function u(a) {
            var b = a.options.inputClass;
            return new(b ? b : oa ? Q : pa ? K : ea ? R : L)(a, w)
        }

        function w(a, b, d) {
            var e, f, g = d.pointers.length,
                h = d.changedPointers.length;
            e = b & 1 && 0 === g - h;
            d.isFirst = !!e;
            d.isFinal = !!(b & 12 && 0 === g - h);
            e && (a.session = {});
            d.eventType = b;
            b = a.session;
            g = d.pointers;
            h = g.length;
            b.firstInput || (b.firstInput = aa(d));
            1 < h && !b.firstMultiple ?
                b.firstMultiple = aa(d) : 1 === h && (b.firstMultiple = !1);
            e = b.firstInput;
            f = (h = b.firstMultiple) ? h.center : e.center;
            var l = d.center = ba(g);
            d.timeStamp = S();
            d.deltaTime = d.timeStamp - e.timeStamp;
            d.angle = T(f, l);
            d.distance = J(f, l);
            e = d.center;
            f = b.offsetDelta || {};
            var l = b.prevDelta || {},
                q = b.prevInput || {};
            if (1 === d.eventType || 4 === q.eventType) l = b.prevDelta = {
                x: q.deltaX || 0,
                y: q.deltaY || 0
            }, f = b.offsetDelta = {
                x: e.x,
                y: e.y
            };
            d.deltaX = l.x + (e.x - f.x);
            d.deltaY = l.y + (e.y - f.y);
            d.offsetDirection = ca(d.deltaX, d.deltaY);
            f = d.deltaTime;
            e = d.deltaX /
                f || 0;
            f = d.deltaY / f || 0;
            d.overallVelocityX = e;
            d.overallVelocityY = f;
            d.overallVelocity = H(e) > H(f) ? e : f;
            h ? (e = h.pointers, e = J(g[0], g[1], M) / J(e[0], e[1], M)) : e = 1;
            d.scale = e;
            h ? (h = h.pointers, g = T(g[1], g[0], M) + T(h[1], h[0], M)) : g = 0;
            d.rotation = g;
            d.maxPointers = b.prevInput ? d.pointers.length > b.prevInput.maxPointers ? d.pointers.length : b.prevInput.maxPointers : d.pointers.length;
            f = b.lastInterval || d;
            g = d.timeStamp - f.timeStamp;
            8 != d.eventType && (25 < g || f.velocity === t) ? (e = d.deltaX - f.deltaX, f = d.deltaY - f.deltaY, l = e / g || 0, q = f / g || 0, g = l, h =
                q, l = H(l) > H(q) ? l : q, e = ca(e, f), b.lastInterval = d) : (l = f.velocity, g = f.velocityX, h = f.velocityY, e = f.direction);
            d.velocity = l;
            d.velocityX = g;
            d.velocityY = h;
            d.direction = e;
            b = a.element;
            c(d.srcEvent.target, b) && (b = d.srcEvent.target);
            d.target = b;
            a.emit("hammer.input", d);
            a.recognize(d);
            a.session.prevInput = d
        }

        function aa(a) {
            for (var b = [], c = 0; c < a.pointers.length;) b[c] = {
                clientX: I(a.pointers[c].clientX),
                clientY: I(a.pointers[c].clientY)
            }, c++;
            return {
                timeStamp: S(),
                pointers: b,
                center: ba(b),
                deltaX: a.deltaX,
                deltaY: a.deltaY
            }
        }

        function ba(a) {
            var b =
                a.length;
            if (1 === b) return {
                x: I(a[0].clientX),
                y: I(a[0].clientY)
            };
            for (var c = 0, d = 0, e = 0; e < b;) c += a[e].clientX, d += a[e].clientY, e++;
            return {
                x: I(c / b),
                y: I(d / b)
            }
        }

        function ca(a, b) {
            return a === b ? 1 : H(a) >= H(b) ? 0 > a ? 2 : 4 : 0 > b ? 8 : 16
        }

        function J(a, b, c) {
            c || (c = fa);
            var d = b[c[0]] - a[c[0]];
            a = b[c[1]] - a[c[1]];
            return Math.sqrt(d * d + a * a)
        }

        function T(a, b, c) {
            c || (c = fa);
            return 180 * Math.atan2(b[c[1]] - a[c[1]], b[c[0]] - a[c[0]]) / Math.PI
        }

        function L() {
            this.evEl = qa;
            this.evWin = ra;
            this.allow = !0;
            this.pressed = !1;
            z.apply(this, arguments)
        }

        function Q() {
            this.evEl =
                ga;
            this.evWin = ha;
            z.apply(this, arguments);
            this.store = this.manager.session.pointerEvents = []
        }

        function ia() {
            this.evTarget = "touchstart";
            this.evWin = "touchstart touchmove touchend touchcancel";
            this.started = !1;
            z.apply(this, arguments)
        }

        function K() {
            this.evTarget = sa;
            this.targetIds = {};
            z.apply(this, arguments)
        }

        function ta(a, b) {
            var d = g(a.touches),
                e = this.targetIds;
            if (b & 3 && 1 === d.length) return e[d[0].identifier] = !0, [d, d];
            var f, l = g(a.changedTouches),
                q = [],
                z = this.target;
            f = d.filter(function(a) {
                return c(a.target, z)
            });
            if (1 ===
                b)
                for (d = 0; d < f.length;) e[f[d].identifier] = !0, d++;
            for (d = 0; d < l.length;) e[l[d].identifier] && q.push(l[d]), b & 12 && delete e[l[d].identifier], d++;
            if (q.length) return [h(f.concat(q), "identifier", !0), q]
        }

        function R() {
            z.apply(this, arguments);
            var a = F(this.handler, this);
            this.touch = new K(this.manager, a);
            this.mouse = new L(this.manager, a)
        }

        function U(a, b) {
            this.manager = a;
            this.set(b)
        }

        function ua(a) {
            if (-1 < a.indexOf("none")) return "none";
            var b = -1 < a.indexOf("pan-x"),
                c = -1 < a.indexOf("pan-y");
            return b && c ? "none" : b || c ? b ? "pan-x" :
                "pan-y" : -1 < a.indexOf("manipulation") ? "manipulation" : "auto"
        }

        function E(a) {
            a = m({}, a || {});
            this.id = va++;
            this.manager = null;
            this.options = B(a, this.defaults);
            a = this.options.enable;
            this.options.enable = a === t ? !0 : a;
            this.state = 1;
            this.simultaneous = {};
            this.requireFail = []
        }

        function ja(a) {
            return a & 16 ? "cancel" : a & 8 ? "end" : a & 4 ? "move" : a & 2 ? "start" : ""
        }

        function ka(a) {
            return 16 == a ? "down" : 8 == a ? "up" : 2 == a ? "left" : 4 == a ? "right" : ""
        }

        function N(a, b) {
            var c = b.manager;
            return c ? c.get(a) : a
        }

        function C() {
            E.apply(this, arguments)
        }

        function O() {
            C.apply(this,
                arguments);
            this.pY = this.pX = null
        }

        function V() {
            C.apply(this, arguments)
        }

        function W() {
            E.apply(this, arguments);
            this._input = this._timer = null
        }

        function X() {
            C.apply(this, arguments)
        }

        function Y() {
            C.apply(this, arguments)
        }

        function P() {
            E.apply(this, arguments);
            this.pCenter = this.pTime = !1;
            this._input = this._timer = null;
            this.count = 0
        }

        function G(a, b) {
            b = b || {};
            var c = b.recognizers;
            b.recognizers = c === t ? G.defaults.preset : c;
            return new Z(a, b)
        }

        function Z(a, b) {
            b = b || {};
            this.options = B(b, G.defaults);
            this.options.inputTarget = this.options.inputTarget ||
                a;
            this.handlers = {};
            this.session = {};
            this.recognizers = [];
            this.element = a;
            this.input = u(this);
            this.touchAction = new U(this, this.options.touchAction);
            la(this, !0);
            p(b.recognizers, function(a) {
                var b = this.add(new a[0](a[1]));
                a[2] && b.recognizeWith(a[2]);
                a[3] && b.requireFailure(a[3])
            }, this)
        }

        function la(a, b) {
            var c = a.element;
            c.style && p(a.options.cssProps, function(a, d) {
                c.style[l(c.style, d)] = b ? a : ""
            })
        }

        function wa(a, b) {
            var c = r.createEvent("Event");
            c.initEvent(a, !0, !0);
            c.gesture = b;
            b.target.dispatchEvent(c)
        }
        var da = " webkit moz MS ms o".split(" "),
            xa = r.createElement("div"),
            I = Math.round,
            H = Math.abs,
            S = Date.now,
            va = 1,
            ya = /mobile|tablet|ip(ad|hone|od)|android/i,
            ea = "ontouchstart" in e,
            oa = l(e, "PointerEvent") !== t,
            pa = ea && ya.test(navigator.userAgent),
            fa = ["x", "y"],
            M = ["clientX", "clientY"];
        z.prototype = {
            handler: function() {},
            init: function() {
                this.evEl && a(this.element, this.evEl, this.domHandler);
                this.evTarget && a(this.target, this.evTarget, this.domHandler);
                this.evWin && a(q(this.element), this.evWin, this.domHandler)
            },
            destroy: function() {
                this.evEl && b(this.element, this.evEl,
                    this.domHandler);
                this.evTarget && b(this.target, this.evTarget, this.domHandler);
                this.evWin && b(q(this.element), this.evWin, this.domHandler)
            }
        };
        var za = {
                mousedown: 1,
                mousemove: 2,
                mouseup: 4
            },
            qa = "mousedown",
            ra = "mousemove mouseup";
        A(L, z, {
            handler: function(a) {
                var b = za[a.type];
                b & 1 && 0 === a.button && (this.pressed = !0);
                b & 2 && 1 !== a.which && (b = 4);
                this.pressed && this.allow && (b & 4 && (this.pressed = !1), this.callback(this.manager, b, {
                    pointers: [a],
                    changedPointers: [a],
                    pointerType: "mouse",
                    srcEvent: a
                }))
            }
        });
        var Aa = {
                pointerdown: 1,
                pointermove: 2,
                pointerup: 4,
                pointercancel: 8,
                pointerout: 8
            },
            Ba = {
                2: "touch",
                3: "pen",
                4: "mouse",
                5: "kinect"
            },
            ga = "pointerdown",
            ha = "pointermove pointerup pointercancel";
        e.MSPointerEvent && (ga = "MSPointerDown", ha = "MSPointerMove MSPointerUp MSPointerCancel");
        A(Q, z, {
            handler: function(a) {
                var b = this.store,
                    c = !1,
                    d = a.type.toLowerCase().replace("ms", ""),
                    d = Aa[d],
                    e = Ba[a.pointerType] || a.pointerType,
                    g = "touch" == e,
                    h = f(b, a.pointerId, "pointerId");
                d & 1 && (0 === a.button || g) ? 0 > h && (b.push(a), h = b.length - 1) : d & 12 && (c = !0);
                0 > h || (b[h] = a, this.callback(this.manager,
                    d, {
                        pointers: b,
                        changedPointers: [a],
                        pointerType: e,
                        srcEvent: a
                    }), c && b.splice(h, 1))
            }
        });
        var Ca = {
            touchstart: 1,
            touchmove: 2,
            touchend: 4,
            touchcancel: 8
        };
        A(ia, z, {
            handler: function(a) {
                var b = Ca[a.type];
                1 === b && (this.started = !0);
                if (this.started) {
                    var c;
                    c = g(a.touches);
                    var d = g(a.changedTouches);
                    b & 12 && (c = h(c.concat(d), "identifier", !0));
                    c = [c, d];
                    b & 12 && 0 === c[0].length - c[1].length && (this.started = !1);
                    this.callback(this.manager, b, {
                        pointers: c[0],
                        changedPointers: c[1],
                        pointerType: "touch",
                        srcEvent: a
                    })
                }
            }
        });
        var Da = {
                touchstart: 1,
                touchmove: 2,
                touchend: 4,
                touchcancel: 8
            },
            sa = "touchstart touchmove touchend touchcancel";
        A(K, z, {
            handler: function(a) {
                var b = Da[a.type],
                    c = ta.call(this, a, b);
                c && this.callback(this.manager, b, {
                    pointers: c[0],
                    changedPointers: c[1],
                    pointerType: "touch",
                    srcEvent: a
                })
            }
        });
        A(R, z, {
            handler: function(a, b, c) {
                var d = "mouse" == c.pointerType;
                if ("touch" == c.pointerType) this.mouse.allow = !1;
                else if (d && !this.mouse.allow) return;
                b & 12 && (this.mouse.allow = !0);
                this.callback(a, b, c)
            },
            destroy: function() {
                this.touch.destroy();
                this.mouse.destroy()
            }
        });
        var ma =
            l(xa.style, "touchAction"),
            na = ma !== t;
        U.prototype = {
            set: function(a) {
                "compute" == a && (a = this.compute());
                na && this.manager.element.style && (this.manager.element.style[ma] = a);
                this.actions = a.toLowerCase().trim()
            },
            update: function() {
                this.set(this.manager.options.touchAction)
            },
            compute: function() {
                var a = [];
                p(this.manager.recognizers, function(b) {
                    D(b.options.enable, [b]) && (a = a.concat(b.getTouchAction()))
                });
                return ua(a.join(" "))
            },
            preventDefaults: function(a) {
                if (!na) {
                    var b = a.srcEvent,
                        c = a.offsetDirection;
                    if (this.manager.session.prevented) b.preventDefault();
                    else {
                        var d = this.actions,
                            e = -1 < d.indexOf("none"),
                            f = -1 < d.indexOf("pan-y"),
                            d = -1 < d.indexOf("pan-x");
                        if (e) {
                            var g = 2 > a.distance,
                                h = 250 > a.deltaTime;
                            if (1 === a.pointers.length && g && h) return
                        }
                        if (!d || !f)
                            if (e || f && c & 6 || d && c & 24) return this.preventSrc(b)
                    }
                }
            },
            preventSrc: function(a) {
                this.manager.session.prevented = !0;
                a.preventDefault()
            }
        };
        E.prototype = {
            defaults: {},
            set: function(a) {
                m(this.options, a);
                this.manager && this.manager.touchAction.update();
                return this
            },
            recognizeWith: function(a) {
                if (k(a, "recognizeWith", this)) return this;
                var b = this.simultaneous;
                a = N(a, this);
                b[a.id] || (b[a.id] = a, a.recognizeWith(this));
                return this
            },
            dropRecognizeWith: function(a) {
                if (k(a, "dropRecognizeWith", this)) return this;
                a = N(a, this);
                delete this.simultaneous[a.id];
                return this
            },
            requireFailure: function(a) {
                if (k(a, "requireFailure", this)) return this;
                var b = this.requireFail;
                a = N(a, this); - 1 === f(b, a) && (b.push(a), a.requireFailure(this));
                return this
            },
            dropRequireFailure: function(a) {
                if (k(a, "dropRequireFailure", this)) return this;
                a = N(a, this);
                a = f(this.requireFail, a); - 1 < a && this.requireFail.splice(a, 1);
                return this
            },
            hasRequireFailures: function() {
                return 0 < this.requireFail.length
            },
            canRecognizeWith: function(a) {
                return !!this.simultaneous[a.id]
            },
            emit: function(a) {
                function b(d) {
                    c.manager.emit(d, a)
                }
                var c = this,
                    d = this.state;
                8 > d && b(c.options.event + ja(d));
                b(c.options.event);
                a.additionalEvent && b(a.additionalEvent);
                8 <= d && b(c.options.event + ja(d))
            },
            tryEmit: function(a) {
                if (this.canEmit()) return this.emit(a);
                this.state = 32
            },
            canEmit: function() {
                for (var a = 0; a < this.requireFail.length;) {
                    if (!(this.requireFail[a].state &
                            33)) return !1;
                    a++
                }
                return !0
            },
            recognize: function(a) {
                a = m({}, a);
                D(this.options.enable, [this, a]) ? (this.state & 56 && (this.state = 1), this.state = this.process(a), this.state & 30 && this.tryEmit(a)) : (this.reset(), this.state = 32)
            },
            process: function(a) {},
            getTouchAction: function() {},
            reset: function() {}
        };
        A(C, E, {
            defaults: {
                pointers: 1
            },
            attrTest: function(a) {
                var b = this.options.pointers;
                return 0 === b || a.pointers.length === b
            },
            process: function(a) {
                var b = this.state,
                    c = a.eventType,
                    d = b & 6;
                a = this.attrTest(a);
                return d && (c & 8 || !a) ? b | 16 : d || a ?
                    c & 4 ? b | 8 : b & 2 ? b | 4 : 2 : 32
            }
        });
        A(O, C, {
            defaults: {
                event: "pan",
                threshold: 10,
                pointers: 1,
                direction: 30
            },
            getTouchAction: function() {
                var a = this.options.direction,
                    b = [];
                a & 6 && b.push("pan-y");
                a & 24 && b.push("pan-x");
                return b
            },
            directionTest: function(a) {
                var b = this.options,
                    c = !0,
                    d = a.distance,
                    e = a.direction,
                    f = a.deltaX,
                    g = a.deltaY;
                e & b.direction || (b.direction & 6 ? (e = 0 === f ? 1 : 0 > f ? 2 : 4, c = f != this.pX, d = Math.abs(a.deltaX)) : (e = 0 === g ? 1 : 0 > g ? 8 : 16, c = g != this.pY, d = Math.abs(a.deltaY)));
                a.direction = e;
                return c && d > b.threshold && e & b.direction
            },
            attrTest: function(a) {
                return C.prototype.attrTest.call(this,
                    a) && (this.state & 2 || !(this.state & 2) && this.directionTest(a))
            },
            emit: function(a) {
                this.pX = a.deltaX;
                this.pY = a.deltaY;
                var b = ka(a.direction);
                b && (a.additionalEvent = this.options.event + b);
                this._super.emit.call(this, a)
            }
        });
        A(V, C, {
            defaults: {
                event: "pinch",
                threshold: 0,
                pointers: 2
            },
            getTouchAction: function() {
                return ["none"]
            },
            attrTest: function(a) {
                return this._super.attrTest.call(this, a) && (Math.abs(a.scale - 1) > this.options.threshold || this.state & 2)
            },
            emit: function(a) {
                1 !== a.scale && (a.additionalEvent = this.options.event + (1 >
                    a.scale ? "in" : "out"));
                this._super.emit.call(this, a)
            }
        });
        A(W, E, {
            defaults: {
                event: "press",
                pointers: 1,
                time: 500,
                threshold: 5
            },
            getTouchAction: function() {
                return ["auto"]
            },
            process: function(a) {
                var b = this.options,
                    c = a.pointers.length === b.pointers,
                    d = a.distance < b.threshold,
                    e = a.deltaTime > b.time;
                this._input = a;
                if (!d || !c || a.eventType & 12 && !e) this.reset();
                else if (a.eventType & 1) this.reset(), this._timer = n(function() {
                    this.state = 8;
                    this.tryEmit()
                }, b.time, this);
                else if (a.eventType & 4) return 8;
                return 32
            },
            reset: function() {
                clearTimeout(this._timer)
            },
            emit: function(a) {
                8 === this.state && (a && a.eventType & 4 ? this.manager.emit(this.options.event + "up", a) : (this._input.timeStamp = S(), this.manager.emit(this.options.event, this._input)))
            }
        });
        A(X, C, {
            defaults: {
                event: "rotate",
                threshold: 0,
                pointers: 2
            },
            getTouchAction: function() {
                return ["none"]
            },
            attrTest: function(a) {
                return this._super.attrTest.call(this, a) && (Math.abs(a.rotation) > this.options.threshold || this.state & 2)
            }
        });
        A(Y, C, {
            defaults: {
                event: "swipe",
                threshold: 10,
                velocity: .65,
                direction: 30,
                pointers: 1
            },
            getTouchAction: function() {
                return O.prototype.getTouchAction.call(this)
            },
            attrTest: function(a) {
                var b = this.options.direction,
                    c;
                b & 30 ? c = a.overallVelocity : b & 6 ? c = a.overallVelocityX : b & 24 && (c = a.overallVelocityY);
                return this._super.attrTest.call(this, a) && b & a.offsetDirection && a.distance > this.options.threshold && a.maxPointers == this.options.pointers && H(c) > this.options.velocity && a.eventType & 4
            },
            emit: function(a) {
                var b = ka(a.offsetDirection);
                b && this.manager.emit(this.options.event + b, a);
                this.manager.emit(this.options.event, a)
            }
        });
        A(P, E, {
            defaults: {
                event: "tap",
                pointers: 1,
                taps: 1,
                interval: 300,
                time: 250,
                threshold: 2,
                posThreshold: 10
            },
            getTouchAction: function() {
                return ["manipulation"]
            },
            process: function(a) {
                var b = this.options,
                    c = a.pointers.length === b.pointers,
                    d = a.distance < b.threshold,
                    e = a.deltaTime < b.time;
                this.reset();
                if (a.eventType & 1 && 0 === this.count) return this.failTimeout();
                if (d && e && c) {
                    if (4 != a.eventType) return this.failTimeout();
                    c = this.pTime ? a.timeStamp - this.pTime < b.interval : !0;
                    d = !this.pCenter || J(this.pCenter, a.center) < b.posThreshold;
                    this.pTime = a.timeStamp;
                    this.pCenter = a.center;
                    this.count = d && c ?
                        this.count + 1 : 1;
                    this._input = a;
                    if (0 === this.count % b.taps) return this.hasRequireFailures() ? (this._timer = n(function() {
                        this.state = 8;
                        this.tryEmit()
                    }, b.interval, this), 2) : 8
                }
                return 32
            },
            failTimeout: function() {
                this._timer = n(function() {
                    this.state = 32
                }, this.options.interval, this);
                return 32
            },
            reset: function() {
                clearTimeout(this._timer)
            },
            emit: function() {
                8 == this.state && (this._input.tapCount = this.count, this.manager.emit(this.options.event, this._input))
            }
        });
        G.VERSION = "2.0.4";
        G.defaults = {
            domEvents: !1,
            touchAction: "compute",
            enable: !0,
            inputTarget: null,
            inputClass: null,
            preset: [
                [X, {
                    enable: !1
                }],
                [V, {
                        enable: !1
                    },
                    ["rotate"]
                ],
                [Y, {
                    direction: 6
                }],
                [O, {
                        direction: 6
                    },
                    ["swipe"]
                ],
                [P],
                [P, {
                        event: "doubletap",
                        taps: 2
                    },
                    ["tap"]
                ],
                [W]
            ],
            cssProps: {
                userSelect: "none",
                touchSelect: "none",
                touchCallout: "none",
                contentZooming: "none",
                userDrag: "none",
                tapHighlightColor: "rgba(0,0,0,0)"
            }
        };
        Z.prototype = {
            set: function(a) {
                m(this.options, a);
                a.touchAction && this.touchAction.update();
                a.inputTarget && (this.input.destroy(), this.input.target = a.inputTarget, this.input.init());
                return this
            },
            stop: function(a) {
                this.session.stopped = a ? 2 : 1
            },
            recognize: function(a) {
                var b = this.session;
                if (!b.stopped) {
                    this.touchAction.preventDefaults(a);
                    var c, d = this.recognizers,
                        e = b.curRecognizer;
                    if (!e || e && e.state & 8) e = b.curRecognizer = null;
                    for (var f = 0; f < d.length;) c = d[f], 2 === b.stopped || e && c != e && !c.canRecognizeWith(e) ? c.reset() : c.recognize(a), !e && c.state & 14 && (e = b.curRecognizer = c), f++
                }
            },
            get: function(a) {
                if (a instanceof E) return a;
                for (var b = this.recognizers, c = 0; c < b.length; c++)
                    if (b[c].options.event == a) return b[c];
                return null
            },
            add: function(a) {
                if (k(a, "add", this)) return this;
                var b = this.get(a.options.event);
                b && this.remove(b);
                this.recognizers.push(a);
                a.manager = this;
                this.touchAction.update();
                return a
            },
            remove: function(a) {
                if (k(a, "remove", this)) return this;
                var b = this.recognizers;
                a = this.get(a);
                b.splice(f(b, a), 1);
                this.touchAction.update();
                return this
            },
            on: function(a, b) {
                var c = this.handlers;
                p(d(a), function(a) {
                    c[a] = c[a] || [];
                    c[a].push(b)
                });
                return this
            },
            off: function(a, b) {
                var c = this.handlers;
                p(d(a), function(a) {
                    b ? c[a].splice(f(c[a],
                        b), 1) : delete c[a]
                });
                return this
            },
            emit: function(a, b) {
                this.options.domEvents && wa(a, b);
                var c = this.handlers[a] && this.handlers[a].slice();
                if (c && c.length) {
                    b.type = a;
                    b.preventDefault = function() {
                        b.srcEvent.preventDefault()
                    };
                    for (var d = 0; d < c.length;) c[d](b), d++
                }
            },
            destroy: function() {
                this.element && la(this, !1);
                this.handlers = {};
                this.session = {};
                this.input.destroy();
                this.element = null
            }
        };
        m(G, {
            INPUT_START: 1,
            INPUT_MOVE: 2,
            INPUT_END: 4,
            INPUT_CANCEL: 8,
            STATE_POSSIBLE: 1,
            STATE_BEGAN: 2,
            STATE_CHANGED: 4,
            STATE_ENDED: 8,
            STATE_RECOGNIZED: 8,
            STATE_CANCELLED: 16,
            STATE_FAILED: 32,
            DIRECTION_NONE: 1,
            DIRECTION_LEFT: 2,
            DIRECTION_RIGHT: 4,
            DIRECTION_UP: 8,
            DIRECTION_DOWN: 16,
            DIRECTION_HORIZONTAL: 6,
            DIRECTION_VERTICAL: 24,
            DIRECTION_ALL: 30,
            Manager: Z,
            Input: z,
            TouchAction: U,
            TouchInput: K,
            MouseInput: L,
            PointerEventInput: Q,
            TouchMouseInput: R,
            SingleTouchInput: ia,
            Recognizer: E,
            AttrRecognizer: C,
            Tap: P,
            Pan: O,
            Swipe: Y,
            Pinch: V,
            Rotate: X,
            Press: W,
            on: a,
            off: b,
            each: p,
            merge: B,
            extend: m,
            inherit: A,
            bindFn: F,
            prefixed: l
        });
        "function" == typeof define && define.amd ? define(function() {
                return G
            }) :
            "undefined" != typeof module && module.exports ? module.exports = G : e[v] = G
    })(window, document, "Hammer")
} catch (e) {
    console && console.log && console.log(e)
}
(function(e) {
    function r(a, b) {
        a = e(a);
        var c = this;
        this.elem = a;
        this.id = a.attr("id");
        this.pages = [];
        this.opts = b;
        this.currentPage = null;
        this.pageWidth = b.width / 2;
        this.pageHeight = b.height;
        this.startPage = b.startPage;
        this.onShowPage = b.onShowPage;
        this.slideShow = b.slideShow;
        this.slideShowDelay = b.slideShowDelay;
        this.pauseOnHover = b.pauseOnHover;
        this.turnPageDuration = b.turnPageDuration;
        this.foldGradient = b.foldGradient;
        this.foldGradientThreshold = b.foldGradientThreshold;
        this.shadows = b.shadows;
        this.shadowThreshold = b.shadowThreshold;
        this.clipBoundaries = b.clipBoundaries;
        this.zoomLevel = 1;
        this.zoomMax = Math.max(b.zoomMax, 1);
        this.zoomMin = b.zoomMin;
        this.zoomBoundingBox = b.zoomBoundingBox;
        this.zoomStep = b.zoomStep;
        this.onZoom = b.onZoom;
        this.mouseWheel = b.mouseWheel;
        this.flipSound = b.flipSound;
        this.centeredWhenClosed = b.centeredWhenClosed;
        this.sectionDefinition = b.sections;
        this.rtl = !!b.rtl;
        this.closable = b.closable;
        e.wowBook.support.filters = "filters" in a[0];
        (this._isMobile = e.wowBook.utils.isMobile()) && this.mobileSetup();
        a.addClass("wowbook");
        "static" === a.css("position") && a.css("position", "relative");
        var d = a.children();
        if (d.length < b.pageCount) {
            for (var f = b.pageCount - d.length; f--;) a.append("<div />");
            d = a.children()
        }
        f = this.pagesContainer = this.origin = e("<div class='wowbook-origin'></div>").css({
            position: "absolute"
        }).appendTo(a);
        c.bookShadow = e("<div class='wowbook-book-shadow'></div>").appendTo(a).css({
            top: 0,
            position: "absolute",
            display: "none",
            zIndex: 0
        });
        this._controls = {};
        this.controllify(this.opts.controls);
        this.insertPages(d, !0);
        f.append("<div class='wowbook-shadow-clipper'><div class='wowbook-shadow-container'><div class='wowbook-shadow-internal'></div></div></div>");
        c.shadowContainer = e(".wowbook-shadow-container", f);
        c.internalShadow = e(".wowbook-shadow-internal", f);
        c.shadowClipper = e(".wowbook-shadow-clipper", f).css({
            display: "none"
        });
        c.foldShadow = e("<div class='wowbook-shadow-fold'></div>").appendTo(c.shadowContainer);
        c.foldGradientContainer = e("<div class='wowbook-fold-gradient-container'></div>").appendTo(c.shadowContainer);
        c.foldGradientElem = e("<div class='wowbook-fold-gradient'></div>").appendTo(c.foldGradientContainer);
        c.hardPageDropShadow = e("<div class='wowbook-hard-page-dropshadow'></div>").css({
            display: "none"
        }).appendTo(f);
        !e.support.opacity && e.wowBook.support.filters && e.wowBook.applyAlphaImageLoader(["wowbook-fold-gradient", "wowbook-fold-gradient-flipped", "wowbook-shadow-fold", "wowbook-shadow-fold-flipped"]);
        c.shadowContainer.css("position", "relative");
        this.leftHandle = e("<div class='wowbook-handle wowbook-left'></div>").data("corner", "l").appendTo(f);
        this.rightHandle = e("<div class='wowbook-handle wowbook-right'></div>").data("corner", "r").appendTo(f);
        Modernizr.csstransforms3d && (d = e("<div>").css("transform", "perspective(1px)"),
            this.perspectiveUnit = "none" != d.css("transform") ? "px" : "", d = null);
        e.browser.msie && e(".wowbook-handle", a).css({
            backgroundColor: "#fff",
            opacity: "0.01"
        });
        e(".wowbook-handle", f).bind("mousedown.wowbook", function(a) {
            return c.pageEdgeDragStart(a)
        });
        b.curl && e(".wowbook-handle", f).hover(function(a) {
            c.curlTimer || (c.curlTimer = setTimeout(function() {
                var b = a.target == c.leftHandle[0] ? c.leftPage() : c.rightPage();
                if (b) {
                    var d = b.offset();
                    c.curl(b, a.pageY - d.top > c.pageHeight * c.currentScale * c._cssZoom / 2)
                }
            }, 120))
        }, function() {
            c.curlTimer =
                clearTimeout(c.curlTimer);
            c.uncurl()
        });
        var g, h;
        e(".wowbook-handle", f).on("mousedown.wowbook", function() {
            g = e.now();
            h = e(this).data("corner")
        }).on("mouseup.wowbook", function() {
            var a = e(this).data("corner");
            if (!((new Date).getTime() - g > c.opts.handleClickDuration || a != h)) {
                c._cantStopAnimation || c.stopAnimation(!1);
                if ("r" === a) c[c.rtl ? "back" : "advance"]();
                if ("l" === a) c[c.rtl ? "advance" : "back"]();
                h = ""
            }
        });
        var l = !1;
        a.hover(function(a) {
            c.pauseOnHover && (l = c.slideShowTimer, c.stopSlideShow(!0))
        }, function() {
            c.pauseOnHover &&
                l && c.startSlideShow()
        });
        this.clipBoundaries && (this.origin.wrap("<div class='wowbook-clipper'><div class='wowbook-inner-clipper'></div></div>"), e(".wowbook-inner-clipper", a).css({
            position: "absolute",
            width: "100%",
            overflow: "hidden"
        }), this.clipper = e(".wowbook-clipper", a).css({
            position: "absolute",
            left: 0,
            top: 0,
            width: "100%",
            overflow: "hidden",
            zIndex: 1
        }));
        a.wrapInner("<div class='wowbook-zoomwindow'><div class='wowbook-zoomcontent'></div></div>");
        this.zoomWindow = e(".wowbook-zoomwindow", a);
        this.zoomContent =
            e(".wowbook-zoomcontent", a);
        e.browser.ie8mode && this.zoomContent.wrapInner("<div class='IE8-zoom-helper'style='position:relative'></div>");
        this.zoomWindow.css({
            position: "absolute",
            top: 0
        });
        this.zoomContent.css({
            position: "absolute",
            left: 0,
            top: 0
        });
        this.zoomSetup();
        this.setDimensions(2 * b.coverWidth || b.width, b.coverHeight || b.height);
        this.opts.container && this.createContainer();
        this.singlePage(b.singlePage);
        b.responsiveSinglePage && this.responsiveSinglePage();
        b.scaleToFit && (this.scaleToFit(), this.responsive());
        this.fillToc();
        f = b.useTranslate3d;
        Modernizr.csstransforms3d && f && (e.wowBook.useTranslate3d = 1 == f || "mobile" == f && e.wowBook.utils.isMobile());
        b.useScale3d = b.useScale3d && Modernizr.csstransforms3d;
        if (b.deepLinking && this.getLocationHash()) {
            var q;
            try {
                q = c.selectorToPage("#" + this.getLocationHash())
            } catch (z) {}
            void 0 === q && (q = c.locationHashToPage());
            "number" === typeof q && (c.startPage = q, b.moveToViewPort && !t(c.elem) && c.elem[0].scrollIntoView())
        }
        this.flipSound && (this.audio = this.createAudioPlayer());
        this.opts.keyboardNavigation &&
            (q = e.wowBook.defaults.keyboardNavigation, this.rtl && this.opts.keyboardNavigation == q && (this.opts.keyboardNavigation = {
                back: q.advance,
                advance: q.back
            }), e(document).on("keydown.wowbook", function(a) {
                e(a.target).filter("input, textarea, select").length || c.holdedPage || (a.which === c.opts.keyboardNavigation.back && c.back(), a.which === c.opts.keyboardNavigation.advance && c.advance())
            }));
        e(window).on("hashchange.wowbook", function() {
            var a = window.location.hash;
            if (a === c.locationHashSetTo) c.locationHashSetTo = void 0;
            else {
                var d =
                    (a = "" === a && !c.locationEndsInHash()) ? c.startPage : c.locationHashToPage();
                "number" === typeof d && (c.gotoPage(d, !a), a || !b.moveToViewPort || t(c.elem) || c.elem[0].scrollIntoView())
            }
        });
        b.forceBasicPage && (this.foldPage = this.holdHardpage = this.foldPageBasic);
        e.wowBook.support.transform || (this.foldPage = this.foldPageBasic, e.wowBook.support.filters || (this.holdHardpage = this.foldPageBasic));
        this.mouseWheel && ("zoom" == c.mouseWheel && a.bind("mousemove.wowbook mouseenter.wowbook", function(a) {
            c._mousemoveEvent = a
        }), a.mousewheel(function(a,
            b) {
            if (c.mouseWheel) {
                if ("zoom" === c.mouseWheel) {
                    var d = c.elem.offset(),
                        e = c._mousemoveEvent,
                        f = e.pageX - d.left,
                        d = e.pageY - d.top;
                    0 < b && c.zoomIn({
                        x: f,
                        y: d
                    });
                    0 > b && c.zoomOut({
                        x: f,
                        y: d
                    })
                } else 0 < b && c.advance(), 0 > b && c.back();
                return !1
            }
        }));
        this.opts.touchEnabled && this.touchSupport();
        b.toc && this.createToc();
        this.opts.thumbnails && this.createThumbnails();
        this.setupFullscreen();
        this.showPage(this.startPage, !1);
        1 != this.opts.zoomLevel && this.zoom(this.opts.zoomLevel, {
            duration: 0
        });
        this.opts.pdf && this.setPDF(this.opts.pdf);
        this.opts.lightbox && this.lightbox(this.opts.lightbox);
        this.toolbars = [];
        this.opts.toolbar && (this.createToolbar(this.opts.toolbar), this._isMobile && (this.opts.lightbox || this.opts.container) && this.setupMobileToolbar());
        this.setStyle(this.opts.styles || this.opts.style);
        this.showPage(this.startPage, !1);
        this.opts.container && (this.updateContainer(), b.scaleToFit && this.scaleToFit(), b.responsiveSinglePage && this.responsiveSinglePage());
        this.callRAFCallback = function() {
            c.rafCallback()
        };
        window.raf(this.callRAFCallback);
        b.slideShow && this.startSlideShow()
    }

    function v(a, b) {
        var c = Math.cos(b),
            d = Math.sin(b);
        return {
            x: c * a.x - d * a.y,
            y: d * a.x + c * a.y
        }
    }

    function t(a) {
        var b = e(window).height(),
            c = a.offset(),
            d = e(window).scrollTop();
        return c.top > d && c.top + a.height() < d + b
    }

    function n(a, b, c) {
        var d, f, g, h;
        d = f = 0;
        if (!e.wowBook.support.boxSizing) {
            var l;
            d = "none" == a.css("borderTopStyle") ? 0 : p[l = a.css("borderTopWidth")] || parseFloat(l);
            f = "none" == a.css("borderRightStyle") ? 0 : p[l = a.css("borderRightWidth")] || parseFloat(l);
            g = "none" == a.css("borderBottomStyle") ?
                0 : p[l = a.css("borderBottomWidth")] || parseFloat(l);
            h = "none" == a.css("borderLeftStyle") ? 0 : p[l = a.css("borderLeftWidth")] || parseFloat(l);
            f = parseFloat(a.css("paddingLeft")) + parseFloat(a.css("paddingRight")) + h + f;
            d = parseFloat(a.css("paddingTop")) + parseFloat(a.css("paddingBottom")) + d + g
        }
        a.css("width", b - f);
        a.css("height", c - d)
    }
    e.wowBook = function(a) {
        return e(a).data("wowBook")
    };
    e.wowBook.version = "1.2.3";
    e.wowBook.support = {};
    e.fn.wowBook = function(a) {
        if ("string" === typeof a) {
            var b = Array.prototype.slice.call(arguments,
                1);
            if ("options" === a || "prop" === a) {
                var c = e.wowBook(this[0]),
                    d = b[0];
                return 1 < b.length ? c[d] = b[1] : c[d]
            }
            return this.each(function() {
                var c = e.wowBook(this);
                c[a].apply(c, b)
            })
        }
        var f = e.extend({}, e.wowBook.defaults, a);
        return this.each(function() {
            if (e.wowBook(this)) console.log("Error: the following element cannot be used twice by wowBook plugin: ", this);
            else {
                var a = new r(this, f);
                e(this).data("wowBook", a)
            }
        })
    };
    r.prototype = {
        destroy: function() {
            this.callRAFCallback = e.noop;
            this.curlTimer = clearTimeout(this.curlTimer);
            e("*").add(document).add(window).off(".wowbook");
            this.destroyThumbnails();
            this.destroyToc();
            this.destroyToolbars();
            this.destroyLightbox();
            this.stopSlideShow();
            this.stopAnimation(!1);
            this.elem.empty().removeData().off()
        },
        mobileSetup: function() {
            this.opts.hardPageShadow = !1
        },
        setDimensions: function(a, b) {
            this.zoomed && this.zoomReset(0);
            this.currentScale = 1;
            var c = this.elem,
                d = this.pageWidth;
            c.css({
                height: b,
                width: a
            });
            var f = c.height();
            this.pageWidth = c.width() / 2;
            this.pageHeight = f;
            this._originalHeight || (this._originalHeight =
                this.pageHeight);
            this._originalWidth || (this._originalWidth = 2 * this.pageWidth);
            var g = this.origin.css({
                width: "100%",
                height: f
            });
            if (d && this.centeredWhenClosed) {
                var h = parseFloat(g.css("left"), 10);
                g.css("left", h / (d / this.pageWidth))
            }
            this.bookShadow.css({
                width: a,
                height: b
            });
            this.setPagesDimension();
            this.positionBookShadow();
            this.shadowClipper.css({
                width: c.width(),
                height: f
            });
            this.hardPageDropShadow.css({
                width: this.pageWidth,
                height: this.pageHeight
            });
            this.opts.handleWidth && e(".wowbook-handle", g).css("width", this.opts.handleWidth);
            this.rightHandle.css("left", a - this.rightHandle.width());
            this.clipBoundaries && (d = Math.ceil(Math.sqrt(this.pageWidth * this.pageWidth + this.pageHeight * this.pageHeight)), d = [this.pageHeight - d, c.width(), d, 0], this.origin.css("top", -d[0]), e(".wowbook-inner-clipper", c).css({
                width: "100%",
                height: d[2] - d[0],
                top: d[0]
            }), this.clipper.css({
                width: "100%",
                height: f
            }));
            this.zoomWindow.css({
                width: 2 * this.pageWidth,
                height: f
            });
            this.zoomContent.css({
                width: 2 * this.pageWidth,
                height: f
            });
            this.corners = {
                tl: [0, 0],
                bl: [0, this.pageHeight],
                tr: [this.pageWidth, 0],
                br: [this.pageWidth, this.pageHeight],
                l: [0, 0],
                r: [this.pageWidth, 0]
            };
            this.pdf && this.pdfResetPages();
            this.thumbnails && this.updateThumbnails()
        },
        setPagesDimension: function() {
            for (var a, b, c, d = 0, f = this.pages.length; d < f; d++) page = this.pages[d], b = page.isCover ? this.pageWidth : this.opts.pageWidth || this.pageWidth, c = page.isCover ? this.pageHeight : this.opts.pageHeight || this.pageHeight, page.pageWidth = b, page.pageHeight = c, page.css({
                width: b,
                height: c,
                left: page.onLeft ? 0 : this.pageWidth
            }), a = e(".wowbook-page-content",
                page), n(a, b, c), this.setPageCorners(page), this.opts.gutterShadow && e(".wowbook-gutter-shadow", this.elem).css("height", c)
        },
        setPageCorners: function(a) {
            var b = 0 + a.pageWidth,
                c = 0 + a.pageHeight;
            a.corners = {
                tl: [0, 0],
                bl: [0, c],
                tr: [b, 0],
                br: [b, c],
                l: [0, 0],
                r: [b, 0]
            }
        },
        setPagePosition: function(a) {
            a.left = a.onLeft ? this.pageWidth - a.pageWidth : this.pageWidth;
            a.top = Math.floor((this.pageHeight - a.pageHeight) / 2);
            a.css({
                left: a.left,
                top: a.top
            })
        },
        scale: function(a) {
            if (e.wowBook.support.transform) {
                this.zoomed && this.zoom(1, 0, {
                    offset: {
                        dx: 0,
                        dy: 0
                    }
                });
                this.currentScale = a;
                var b = this.zoomContent;
                this.opts.zoomUsingTransform ? b.css({
                    transform: "scale(" + a + ")",
                    transformOrigin: "0 0"
                }) : (b.css("zoom", a), this._cssZoom = a * this.zoomLevel);
                this.elem.css({
                    height: this._originalHeight * a,
                    width: this._originalWidth * a
                });
                this.zoomWindow.css({
                    height: this._originalHeight * a,
                    width: this._originalWidth * a
                });
                this.resizeHandles();
                if (this.opts.onResize) this.opts.onResize(this)
            }
        },
        scaleToFit: function(a, b) {
            var c = a;
            if (!e.isNumeric(a)) {
                var d = e(a || this.opts.scaleToFit);
                if (!d.length) throw "jQuery selector passed to wowbook.resize did not matched in any DOM element.";
                c = d.width();
                b = d.height()
            }
            this.opts.maxWidth && c > this.opts.maxWidth && (c = this.opts.maxWidth);
            this.opts.maxHeight && b > this.opts.maxHeight && (b = this.opts.maxHeight);
            this._singlePage && (c *= 2);
            d = this._originalWidth / this._originalHeight;
            b * d <= c || (b = c / d);
            this.scale(b / this._originalHeight)
        },
        resize: function(a, b) {
            this.setDimensions(a, b);
            if (this.opts.onResize) this.opts.onResize(this)
        },
        responsive: function() {
            var a = this;
            e(window).on("resize.wowbook", function() {
                a.responsiveUpdater()
            })
        },
        responsiveUpdater: function() {
            this.opts.container &&
                this.updateContainer();
            this.responsiveSinglePage();
            this.scaleToFit();
            this.lightboxOn && this.centerLightbox()
        },
        responsiveSinglePage: function(a) {
            if (a = void 0 != a ? a : this.opts.responsiveSinglePage) e.isFunction(a) || (a = function(a) {
                if (!this._isMobile) return !1;
                a = e(a.opts.scaleToFit);
                var c = a.width();
                return a.height() > c
            }), this.singlePage(this.opts.singlePage || a.call(this, this))
        },
        resizeHandles: function() {
            if (this.opts.responsiveHandleWidth) {
                var a = this.opts.responsiveHandleWidth / this.currentScale;
                e(".wowbook-handle").width(a);
                this.rightHandle.css("left", 2 * this.pageWidth - a)
            }
        },
        insertPages: function(a, b) {
            for (var c = 0, d = a.length; c < d; c++) this.insertPage(a[c], !0);
            this.updateBook(b)
        },
        insertPage: function(a, b) {
            if (this.isDoublePage(a)) this.insertDoublePage(a, b);
            else {
                a = e(a).addClass("wowbook-page-content");
                var c = e("<div class='wowbook-page'></div>").css({
                    width: this.pageWidth,
                    height: this.pageHeight,
                    display: "none",
                    position: "absolute"
                }).appendTo(this.pagesContainer).append(a);
                e.wowBook.support.boxSizing && a.css(e.wowBook.support.boxSizing,
                    "border-box");
                n(a, this.pageWidth, this.pageHeight);
                c.hardPageSetByUser = a.hasClass("wowbook-hardpage");
                this.opts.gutterShadow && this.upsertGutterShadowInPage(c);
                this.pages.push(c);
                b || this.updateBook();
                return c
            }
        },
        insertDoublePage: function(a, b) {
            if (!this._insertingDoublePage) {
                this._insertingDoublePage = !0;
                var c = e(a),
                    d = c.clone().insertAfter(c),
                    f = c.add(d);
                c.css("left", 0);
                d.css("right", "100%");
                f.css({
                    width: "200%",
                    height: "100%",
                    position: "relative"
                });
                f.css(e.wowBook.support.boxSizing + "", "border-box").wrap("<div class='wowbook-double-page'></div>");
                c.parent().data("src", c.data("src"));
                d.parent().data("src", d.data("src"));
                c.parent().data("image", c.data("image"));
                d.parent().data("image", d.data("image"));
                var f = this.insertPage(c.parent(), !0),
                    g = this.insertPage(d.parent(), !0);
                f && (f.otherHalf = g);
                g && (g.otherHalf = f);
                e.wowBook.support.boxSizing || (n(c, 2 * this.pageWidth, this.pageHeight), n(d, 2 * this.pageWidth, this.pageHeight));
                b || this.updateBook();
                this._insertingDoublePage = !1
            }
        },
        isDoublePage: function(a) {
            a = e(a);
            return a.data("double") || a.is(this.opts.doublePages)
        },
        replaceNumberHolder: function(a, b) {
            if (void 0 == a) return a;
            b += "";
            return a.replace(/\{\{([^}]+)\}\}/g, function(a, d) {
                if (b.length < d.length) {
                    var e = d.replace(/./g, "0");
                    return (e + b).slice(-e.length)
                }
                return b
            })
        },
        loadPage: function(a) {
            "number" === typeof a && (a = this.pages[a]);
            if (a && !a.loaded && !a.loading && (a.src || a.image || a.cached || this.pdfDoc)) {
                if (a.cached) return this.finishPageLoading(a, a.cache);
                a.loading = !0;
                var b = this;
                if (a.src) a.otherHalf && a.otherHalf.loading || e.get(a.src, function(c) {
                    b.finishPageLoading(a, c);
                    a.otherHalf &&
                        b.finishPageLoading(a.otherHalf, c)
                });
                else if (a.image) {
                    var c = new Image;
                    c.onload = function() {
                        b.finishPageLoading(a, this)
                    };
                    e(c).addClass("wowbook-lazy");
                    c.src = a.image
                } else this.pdfDoc && b.pdfLoadPage(a.pageIndex)
            }
        },
        finishPageLoading: function(a, b) {
            a.loading = !1;
            a.loaded = !0;
            var c = !a.cached;
            a.cached = !1;
            a.removeClass("wowbook-loading");
            var d = a.find(".wowbook-page-content");
            c && (a.image || a.src) && this.isDoublePage(d.children().first()) && (d = d.children().first());
            d.append(b);
            this.upsertNumberInPage(a);
            this.opts.gutterShadow &&
                this.upsertGutterShadowInPage(a);
            if (this.opts.onLoadPage) this.opts.onLoadPage(this, a, a.pageIndex);
            this.updateThumbnail(a.pageIndex)
        },
        unloadPage: function(a) {
            "number" === typeof a && (a = this.pages[a]);
            if (a && a.loaded && !this.isPageToKeep(a) && (a.cache = a.find(".wowbook-page-content").html(), a.find(".wowbook-page-content").empty(), a.cached = !0, a.loaded = !1, this.pdfDoc && (a.cache = void 0, a.cached = !1), this.opts.onUnloadPage)) this.opts.onUnloadPage(this, a, a.pageIndex)
        },
        isPageToKeep: function(a) {
            if (!this.opts.pagesToKeep) return !1;
            var b = a.find(".wowbook-page-content");
            return a.keep || b.data("keep") || b.is(this.opts.pagesToKeep)
        },
        selectPagesToUnload: function(a) {
            void 0 == a && (a = this.currentPage);
            var b = [],
                c = this.leftPageIndex(a);
            a = this.rightPageIndex(a);
            for (var d = this.pageBelow(c), e = this.pageBelow(a), g = this.backPage(c), h = this.backPage(a), g = g && g.pageIndex, h = h && h.pageIndex, l = 0, q = this.pages.length; l < q; l++) {
                var z = this.pages[l];
                z.loaded && l != c && l != a && l != d && l != e && l != g && l != h && !this.isPageToKeep(z) && b.push(l)
            }
            return b
        },
        loadedPages: function() {
            for (var a = [], b = 0, c = this.pages.length; b < c; b++) this.pages[b].loaded && a.push(b);
            return a
        },
        unloadUnusedPages: function(a) {
            var b = this.loadedPages();
            if (!(b.length <= this.opts.pagesInMemory)) {
                b = b.length - this.opts.pagesInMemory;
                a = this.selectPagesToUnload(a);
                for (var c = 0; c < b; c++) this.unloadPage(a[c])
            }
        },
        removePages: function(a, b) {
            arguments.length || (a = 0, b = -1);
            this.holdedPage && this.releasePage(this.holdedPage);
            var c = this.pages;
            b = (b || a) + 1 || c.length;
            var d = c.slice(a, b),
                e = c.slice(b);
            c.length = 0 > a ? c.length + a : a;
            c.push.apply(c, e);
            for (var e = 0, g = d.length; e < g; e++) d[e].remove();
            this.updateBook();
            return c.length
        },
        updateBook: function(a) {
            this.doPageNumbering();
            this.findPagesType();
            this.positionBookShadow();
            var b = this.rtl && this.closable || !this.rtl && !this.closable,
                c = this.opts.pageWidth || this.opts.pageHeight,
                d;
            this.differentPageSizes = c;
            for (var f = 0, g = this.pages.length - 1; f <= g; f++) {
                d = this.pages[f].toggleClass("wowbook-left", b).toggleClass("wowbook-right", !b).data({
                    pageIndex: f,
                    holded: !1
                });
                d.pageIndex = f;
                d.cover = !1;
                d.insideCover = !1;
                d.isCover =
                    c && (0 == f || f == g || this.closable && 1 == f || f == g - 1 && !this.otherPage(g));
                var h = e(".wowbook-page-content", d);
                d.src = this.replaceNumberHolder(h.data("src") || this.opts.srcs, f);
                d.image = this.replaceNumberHolder(h.data("image") || this.opts.images, f);
                1 != d.loaded && (d.loaded = !d.src && !d.image && !d.cached);
                d.loaded || d.addClass("wowbook-loading");
                d.onLeft = b;
                d.onRight = !b;
                b = !b;
                d.thickness = this.opts.pageThickness;
                c && (d.thickness = d.isCover ? this.opts.pageThickness : "1px")
            }
            this.setCovers();
            this.setPagesDimension();
            this.findSections();
            this._controls && this._controls.pagecount && this._controls.pagecount.text(this.pages.length);
            a || this.showPage(this.currentPage)
        },
        setCovers: function() {
            function a(a) {
                if (0 == a || a == b) {
                    var d = c.pages[a];
                    if (d) {
                        var e = c.backPage(a);
                        c.otherPage(a) ? e || (d.cover = !1, d.insideCover = !0) : (d.cover = !0, d.insideCover = !1, e && !e.cover && (e.insideCover = !0))
                    }
                }
            }
            var b = this.pages.length - 1,
                c = this;
            a(0);
            a(b);
            c.insideCoverLeft = null;
            c.insideCoverRight = null;
            for (var d = 0, e = this.pages.length - 1; d <= e; d++) c.pages[d].insideCover && (c.pages[d].onLeft ?
                c.insideCoverLeft = c.pages[d] : c.insideCoverRight = c.pages[d])
        },
        singlePage: function(a) {
            if (void 0 !== a) {
                (this._singlePage = !!a) ? this.clipBoundaries && (this.clipBoundaries = !1, this._restoreClipBoundaries = !0, this.clipper.css("overflow", "visible"), this.clipper.children(".wowbook-inner-clipper").css("overflow", "visible")): this._restoreClipBoundaries && (this._restoreClipBoundaries = !1, this.clipBoundaries = !0, this.clipper.css("overflow", "hidden"), this.clipper.children(".wowbook-inner-clipper").css("overflow", "visible"));
                a = 0;
                var b = this.pageWidth;
                if (this._singlePage) a = this.pageIsOnTheRight(this.currentPage) ? -b : 0;
                else if (this.centeredWhenClosed) {
                    a = !!this.leftPage(this.currentPage);
                    var c = this.rightPage(this.currentPage);
                    a = a && c ? 0 : a ? b / 2 : -b / 2
                }
                this.origin.css("left", a);
                this.positionBookShadow()
            }
            return this._singlePage
        },
        doPageNumbering: function() {
            var a = this.opts;
            if (a.pageNumbers && this.pages.length) {
                var b = a.numberedPages,
                    a = this.pages.length - 1,
                    c = this.pageIsOnTheLeft(a);
                "all" == b && (b = [0, -1]);
                b || (b = this.closable ? [2, c ? -3 : -2] : [0, -1]);
                var d = b[0],
                    b = b[1];
                0 > d && (d = a + d + 1);
                0 > d && (d = 0);
                d > this.pages.length - 1 && (d = a);
                0 > b && (b = a + b + 1);
                0 > b && (b = 0);
                b > this.pages.length - 1 && (b = a);
                for (var f = this.opts.firstPageNumber, c = 0; c < a; c++) delete this.pages[c].number;
                for (c = 0; c < d; c++) e(".wowbook-page-number", this.pages[c]).remove();
                for (c = b + 1; c < a; c++) e(".wowbook-page-number", this.pages[c]).remove();
                for (c = d; c <= b; c++) this.pages[c].number = f, a = e(".wowbook-page-number", this.pages[c]), a.length || (a = e(".wowbook-page-content", this.pages[c]), a = e('<div class="wowbook-page-number"></div>').appendTo(a)),
                    a.html(f++)
            }
        },
        upsertNumberInPage: function(a) {
            "number" === typeof a && (a = this.pages[a]);
            if (a.number || 0 === a.number) {
                var b = e(".wowbook-page-number", a);
                b.length || (content = e(".wowbook-page-content", a), b = e('<div class="wowbook-page-number"></div>').appendTo(content));
                b.html(a.number)
            }
        },
        upsertGutterShadowInPage: function(a) {
            "number" === typeof a && (a = this.pages[a]);
            a.find(".wowbook-gutter-shadow").length || (a = a.find(".wowbook-page-content"), e("<div class='wowbook-gutter-shadow'>").css("height", this.pageHeight).appendTo(a))
        },
        findPagesType: function() {
            var a = this.opts,
                b = {},
                c, d, e;
            e = a.hardPages || [];
            var g = !0 === e;
            if (!g)
                for (a.hardcovers && (e.push(0, -1), this.closable && e.push(1), this.otherPage(this.pages.length - 1) || e.push(-2)), a = 0, d = e.length; a < d; a++) c = e[a], 0 > c && (c = this.pages.length + c), 0 <= c && c < this.pages.length && (b[c] = !0);
            for (a = this.pages.length; a--;) e = g || b[a] || this.pages[a].hardPageSetByUser, this.pages[a].toggleClass("wowbook-hardpage", e).isHardPage = e
        },
        showPage: function(a, b) {
            0 > a && (a = 0);
            a > this.pages.length - 1 && (a = this.pages.length -
                1);
            var c = this.leftPageIndex(a),
                d = this.rightPageIndex(a),
                f = this.pageBelow(c),
                g = this.pageBelow(d),
                h = this.pageWidth,
                l = this.pages.length - 1,
                q, z;
            this.loadPage(c);
            this.loadPage(d);
            this.loadPage(f);
            this.loadPage(g);
            this.loadPage(this.backPage(c));
            this.loadPage(this.backPage(d));
            this.opts.pagesInMemory && this.unloadUnusedPages(a);
            for (var u = 0; u <= l; u++) q = this.pages[u].onLeft != this.rtl ? u : l - u, z = u === f || u === c || u === d || u === g ? "block" : "none", this.pages[u].data("zIndex", q).css({
                display: z,
                left: this.pages[u].onLeft ? 0 : h,
                top: 0,
                zIndex: q
            }), this.setPagePosition(this.pages[u]);
            this.differentPageSizes && (null !== f && this.insideCoverLeft.css("display", "block"), null !== g && this.insideCoverRight.css("display", "block"));
            f = 0 == a || !this.closable && 1 == a;
            l = a == l || a == this.otherPage(l);
            this.leftHandle.toggleClass("wowbook-disabled", !this.backPage(c));
            this.rightHandle.toggleClass("wowbook-disabled", !this.backPage(d));
            this.toggleControl("back", f);
            this.toggleControl("next", l);
            this.toggleControl("first", f);
            this.toggleControl("last", l);
            (l = this.onShowPage) &&
            e.isFunction(l) && !this.isOnPage(a) && (this.currentPage = a, l(this, this.pages[a], a), (f = this.otherPage(a)) && l(this, this.pages[f], f));
            this.currentPage = a;
            this._controls.currentpage && (l = this.currentPage + 1, this.singlePage() || (l = [], e.isNumeric(c) && l.push(c + 1), e.isNumeric(d) && l.push(d + 1), l = l.join("-")), this._controls.currentpage.text(l).val(l));
            this._sliding || (c = this._singlePage && this.pageIsOnTheRight(a) ? -h : 0, this.origin.css("left", c), this.origin.css("transform", ""));
            this.centeredWhenClosed && !this._singlePage &&
                (c = !!this.leftPage(a), d = this.rightPage(a), this.origin.css("left", c && d ? 0 : c ? h / 2 : -h / 2));
            this.positionBookShadow();
            !1 !== b && this.opts.updateBrowserURL && this.locationHashToPage() != a && (this.locationHashSetTo = window.location.hash = this.pageToLocationHash(a));
            this.showThumbnail()
        },
        slideX: function(a, b) {
            var c = parseFloat(this.origin.css("left")),
                d = a - c;
            this.origin.css("left", 0);
            var f = this;
            this._move = 0;
            this._sliding = !0;
            e(this).animate({
                _move: 1
            }, {
                duration: this.opts.turnPageDuration,
                easing: "linear",
                complete: function() {
                    this._sliding = !1;
                    this.origin.css("transform", "");
                    this.origin.css("left", a);
                    this.positionBookShadow();
                    e.isFunction(b) && b()
                },
                step: function(a, b) {
                    f.translate(this.origin, c + a * d);
                    this.positionBookShadow()
                }
            })
        },
        holdPage: function(a, b, c, d, e) {
            "number" === typeof a && (a = this.pages[a]);
            if (a) {
                var g = a.pageIndex,
                    h = this.pages.length - 1,
                    l = !this.otherPage(h);
                if (!d) d = this.pageIsOnTheLeft(g) ? "l" : "r";
                else if (!this.corners[d] || (this.pageIsOnTheLeft(g) ? /r/ : /l/).test(d)) return;
                void 0 === e && (e = this.backPage(g));
                if (e) {
                    var q = e.pageIndex;
                    a.data("holded_info", [b, c, d]);
                    if (!this._singlePage && this.centeredWhenClosed && (0 === g || 0 === q || l && (q === h || g === h))) {
                        var z = 0,
                            u, w = !this.rtl,
                            k = this.pageWidth,
                            m, n, p, r, t, v, A, B;
                        if (w ? 0 === g : g === h && l) m = -k / 2, n = -k / 4, p = 0, r = -k / 2, t = -k, v = n, A = t, B = b;
                        if (w ? g === h && l : 0 === g) m = k, n = 3 * k / 2, p = k / 2, r = 0, t = k, v = 2 * k, A = b, B = v;
                        if (w ? 0 === q : q === h && l) m = k / 2, n = g === (w ? h : 0) ? k : 3 * k / 2, p = g === (w ? h : 0) ? k / 2 : 0, r = -k / 2, t = m, v = 2 * k, A = b, B = v;
                        if (w ? q === h && l : 0 === q) m = g === (w ? 0 : h) ? 0 : -k / 2, n = k / 2, p = k / 2, r = g === (w ? 0 : h) ? -k / 2 : 0, t = -k, v = n, A = t, B = b;
                        b < m && (z = p, u = A);
                        b > n && (z = r, u = B);
                        b >= m && b <= n && (b = (b - m) /
                            (n - m), z = p + b * (r - p), u = t + b * (v - t));
                        b = u;
                        this.origin.css("left", z);
                        this.positionBookShadow()
                    }
                    this.zoomed || "basic" == this.pageType(a) || "basic" == this.pageType(e) ? this.foldPageBasic(a, b, c, d, e) : a.isHardPage || e.isHardPage ? this.holdHardpage(a, b, c, d, e) : this.foldPage(a, b, c, d, e);
                    if (!a.data("holded") && (a.addClass("wowbook-page-holded"), e.addClass("wowbook-page-holded"), a.data("holded", !0), this.holdedPage = a, this.holdedPageBack = e, this.shadows && this.shadowClipper.css("display", "block"), this.clipBoundaries && this.clipper.css("overflow",
                            "visible"), this.positionBookShadow(), this.opts.onHoldPage)) this.opts.onHoldPage(this, g, a, e)
                }
            }
        },
        foldPage: function(a, b, c, d, e) {
            this._currentFlip || (this._currentFlip = this.foldPageStart(a, b, c, d, e));
            this._currentFlip.page == a && (this._currentFlip.x = b, this._currentFlip.y = c, this._currentFlip.page.data("holdedAt", {
                x: b,
                y: c
            }), this._currentFlip.corner = d, this.foldPageStyles(this._currentFlip))
        },
        foldPageStart: function(a, b, c, d, e) {
            var g = {};
            "number" === typeof a && (a = this.pages[a]);
            g.book = this;
            g.page = a;
            g.pageIndex = a.data("pageIndex");
            void 0 === e && (e = this.backPage(g.pageIndex));
            if (e && e.length) {
                g.back = e;
                g.pageContent = a.children().first();
                g.backContent = e.children().first();
                var h = g.page.pageWidth,
                    l = g.page.pageHeight;
                d || (d = "tl");
                if ("l" == d || "r" == d) {
                    var q = {
                        x: "l" == d ? 0 : h,
                        y: c
                    };
                    a.data("grabPoint", q);
                    g.grabPoint = q;
                    d = (c >= q.y ? "t" : "b") + d
                }
                g.page.data("holdedAt", {
                    x: b,
                    y: c
                });
                g.x = b;
                g.y = c;
                g.page.data("holdedCorner", d);
                g.corner = d;
                g.pageDiagonal = Math.sqrt(h * h + l * l);
                b = Math.ceil(g.pageDiagonal);
                b = "rect(-" + b + "px " + b + "px " + b + "px 0px)";
                g.page.css("clip", b);
                g.pageLeft = parseFloat(a.css("left"));
                e.css({
                    left: g.pageLeft + "px",
                    zIndex: 1E5,
                    clip: b
                });
                g.shadowHeight = 2 * Math.ceil(g.pageDiagonal);
                g.shadowTop = -(g.shadowHeight - l) / 2;
                this.shadowClipper.css({
                    top: g.page.top,
                    left: a.onLeft ? a.left : e.left,
                    width: 2 * h,
                    height: l
                });
                this.internalShadow.css({
                    display: "block",
                    height: g.shadowHeight
                });
                g.foldShadowWidth = this.foldShadow.width();
                this.foldShadow.css({
                    display: "block",
                    height: g.shadowHeight
                });
                this.foldGradientContainer.appendTo(g.backContent);
                g.foldGradientWidth = this.foldGradientElem.width();
                g.foldGradientHeight = 2 * Math.ceil(g.pageDiagonal);
                this.foldGradientElem.css("height", g.foldGradientHeight);
                this.foldGradientContainer.css({
                    position: "absolute",
                    width: g.foldGradientWidth,
                    height: g.foldGradientHeight,
                    top: 0,
                    left: 0,
                    display: "none"
                });
                g.foldGradientVisible = !1;
                return g
            }
        },
        foldPageStyles: function(a) {
            var b = a.page.pageWidth,
                c = a.page.pageHeight,
                d = b / 2,
                f = c / 2,
                g = e.wowBook.utils.translate,
                h = a.x,
                l = a.y,
                q = a.back,
                k = a.corner || "tl";
            if ("l" == k || "r" == k) {
                var u = a.page.data("grabPoint");
                u || (u = {
                        x: "l" == k ? 0 : b,
                        y: l
                    },
                    page.data("grabPoint", u));
                k = (l >= u.y ? "t" : "b") + (this.pageIsOnTheLeft(a.pageIndex) ? "l" : "r");
                a.corner = k;
                a.page.data("holdedCorner", k);
                var w = h - u.x,
                    m = l - u.y,
                    w = Math.atan2(m, w),
                    u = {
                        x: 0,
                        y: (l >= u.y ? 0 : c) - u.y
                    },
                    u = v(u, 2 * w),
                    h = u.x + h,
                    l = u.y + l
            }
            a.page.data("holdedAt", {
                x: h,
                y: l
            });
            a.page.data("holdedCorner", k);
            var u = a.page.corners[k],
                k = b - u[0],
                n = u[1],
                w = h - k,
                m = l - n,
                p = Math.sqrt(w * w + m * m);
            p > b && (h = k + b * w / p, l = n + b * m / p);
            var n = c - n,
                w = h - k,
                m = l - n,
                p = Math.sqrt(w * w + m * m),
                r = a.pageDiagonal;
            p > r && (h = k + r * w / p, l = n + r * m / p);
            k = u[0];
            u = u[1];
            u == l && (l = u + .001);
            w = h - k;
            m = l - u;
            p = Math.sqrt(w * w + m * m);
            h = p / 2;
            w = Math.atan2(m, w);
            m = Math.tan(w);
            l = w;
            w = 180 * w / Math.PI;
            n = {
                x: k - d,
                y: f - u
            };
            r = v(n, l);
            p = r.x + h + d + .5;
            a.pageContent.css("transform", g(-p, 0) + " rotate(" + (-w).toFixed(7) + "deg)");
            a.page.css("transform", g((Math.cos(l) * p).toFixed(5), (Math.sin(l) * p).toFixed(5)) + " rotate(" + w.toFixed(7) + "deg)");
            r = this.calculateOpacity(h, b, this.shadowThreshold, 50);
            if (this.shadows && 0 < r) {
                var t = a.shadowTop;
                this.internalShadow.css({
                    transform: g(p + (a.page.onRight ? a.page.pageWidth : 0), t) + " rotate(" + w + "deg)",
                    transformOrigin: d - p + "px " + (f + (a.shadowHeight - c) / 2) + "px"
                });
                p -= a.foldShadowWidth;
                this.foldShadow.css({
                    transform: g(p + (a.page.onRight ? a.page.pageWidth : 0), t) + " rotate(" + w + "deg)",
                    transformOrigin: d - p + "px " + (f + (a.shadowHeight - c) / 2) + "px"
                });
                this.shadowContainer.css({
                    opacity: r,
                    display: "block"
                })
            } else this.shadowContainer.css("display", "none");
            q.show();
            n.x = -n.x;
            r = v(n, -l);
            p = r.x - h + d - 1;
            c = {
                x: r.x - h,
                y: r.y + h * m
            };
            q = {
                x: r.x - h,
                y: r.y - h / (0 == m ? 1E-4 : m)
            };
            c = v(c, -l);
            q = v(q, -l);
            q = -(q.x + d);
            c = -(c.y - f);
            a.backContent.css("transform",
                g(-p, 0) + " rotate(" + w + "deg)");
            a.back.css("transform", g((k + q + Math.cos(l) * p).toFixed(5), (u - c + Math.sin(l) * p).toFixed(5)) + " rotate(" + w + "deg)");
            r = this.calculateOpacity(2 * h, 2 * b, this.foldGradientThreshold, 50);
            this.foldGradient && 0 < r ? (this.foldGradientContainer.css({
                opacity: r,
                display: "block",
                transform: g(b - k - a.foldGradientWidth / 2, u - a.foldGradientHeight / 2) + " rotate(" + -w + "deg)"
            }), this.foldGradientElem.css("transform", g(-h + a.foldGradientWidth / 2, 0)), a.foldGradientVisible || (this.foldGradientContainer.css("display",
                "block"), a.foldGradientVisible = !0)) : a.foldGradientVisible && (this.foldGradientContainer.css("display", "none"), a.foldGradientVisible = !1)
        },
        holdHardpage: function(a, b, c, d, e) {
            this._currentFlip || (this._currentFlip = this.flipHardPageStart(a, b, c, d, e));
            this._currentFlip.page == a && (this._currentFlip.x = b, this._currentFlip.y = c, this._currentFlip.page.data("holdedAt", {
                x: b,
                y: c
            }), this._currentFlip.corner = d, this.flipHardPageStyles(this._currentFlip))
        },
        flipHardPageStart: function(a, b, c, d, f) {
            this.clipBoundaries && this.clipper.children(".wowbook-inner-clipper").css("overflow",
                "visible");
            !this.border3D && this.opts.pageThickness && this.opts.use3d && Modernizr.csstransforms3d && (this.border3D = e('<div class="wowbook-3d-border">'), this.border3D.css("background", this.opts.pageEdgeColor));
            this.opts.hardPageShadow && !this.hardPageShadow && (this.hardPageShadow = e('<div class="wowbook-hard-page-shadow">'));
            var g = {};
            "number" === typeof a && (a = this.pages[a]);
            g.book = this;
            g.page = a;
            g.pageIndex = a.data("pageIndex");
            void 0 === f && (f = this.backPage(g.pageIndex));
            if (f && f.length) {
                g.back = f;
                var h = a.pageWidth;
                d || (d = "tl");
                a.data("holdedAt", {
                    x: b,
                    y: c
                });
                a.data("holdedCorner", d);
                a.css("zIndex", 1E5);
                f.css("zIndex", 1E5);
                this.opts.use3d && Modernizr.csstransforms3d && (a.css(Modernizr.prefixed("perspectiveOrigin"), "0 50%"), f.css(Modernizr.prefixed("perspectiveOrigin"), "0 50%"));
                b = a.onLeft ? h : 0;
                a.css("transformOrigin", b + "px 50%");
                f.css("transformOrigin", h - b + "px 50%");
                this.border3D && this.border3D.css("width", a.thickness);
                this.shadows && this.hardPageDropShadow.css({
                    display: "block",
                    width: a.pageWidth,
                    height: a.pageHeight,
                    top: a.top
                });
                return g
            }
        },
        flipHardPageStyles: function(a) {
            var b = a.page,
                c = a.back,
                d = a.x,
                f = a.y,
                g = this.pageIsOnTheRight(a.pageIndex),
                h = this.pageWidth,
                l = this.pageHeight;
            (a = a.corner) || (a = "tl");
            b.data("holdedAt", {
                x: d,
                y: f
            });
            b.data("holdedCorner", a);
            f = g ? h - d : d;
            a = g ? 0 : h;
            var q;
            0 > f && (f = 0);
            f = (q = f < h) ? b : c;
            (q ? c : b).css("display", "none");
            g = g != q;
            a = d - a;
            a > h && (a = h);
            a < -h && (a = -h);
            var k = -Math.sqrt(1600 * (1 - a * a / ((h + 15) * (h + 15))));
            q = Math.abs(a / h);
            k = 1 == q ? 0 : Math.atan2(k, a);
            if (this.opts.use3d && Modernizr.csstransforms3d) {
                var m;
                m = g ? -this._calculateAngleFromX(-a,
                    h) : this._calculateAngleFromX(a, h);
                if (this.animating) {
                    var n = this._animationData;
                    if (this.curledPage || n.curled) n.curled = !0, n.angle || (k = {
                        from: m,
                        to: 0
                    }, n.angle = k, m = a + n.dx, k.to = g ? -this._calculateAngleFromX(-m, h) : this._calculateAngleFromX(m, h), Math.abs(a) == h && (k.from = 0), Math.abs(m) == h && (k.to = 0), k.delta = k.to - k.from), m = n.angle.from - n.angle.delta * (n.from.x - d) / n.dx
                }
                f.append(this.border3D);
                this.hardPageShadow && (f.append(this.hardPageShadow), this.hardPageShadow.css("opacity", 1 - q));
                f.css({
                    transform: "perspective(" +
                        this.opts.perspective + this.perspectiveUnit + ") rotate3d(0, 1, 0, " + m + "deg)",
                    display: "block"
                })
            } else f.css({
                transform: "skewY(" + k + "rad) scaleX(" + q + ")",
                display: "block"
            });
            !e.wowBook.support.transform && e.wowBook.support.filters && (f.css("filter", "progid:DXImageTransform.Microsoft.Matrix(" + ("M11=" + q + ", M12=0, M21=" + Math.tan(k) * q + ", M22=1") + ", sizingMethod='auto expand')"), f.css({
                marginTop: l - f.height(),
                marginLeft: g ? h - f.width() : 0
            }));
            this.shadows && this.hardPageDropShadow.css({
                left: g ? b.onLeft ? b.left : c.left : h,
                opacity: Math.abs(a) < h / 2 ? 0 : (Math.abs(a) - h / 2) / h * .8
            })
        },
        _calculateAngleFromX: function(a, b, c) {
            var d = 2 * b / 3;
            if (a > d) {
                var e = this._calculateAngleFromX(d, b, c);
                return e + (a - d) / (b - d) * (0 - e)
            }
            c = c || this.opts.perspective;
            d = 180 / Math.PI;
            e = b * b;
            c *= c;
            var g = a * a;
            a = Math.acos((b * c * a - Math.sqrt(e * e * c * g + e * e * g * g - e * c * g * g)) / (e * c + e * g));
            return a = -a * d
        },
        foldPageBasic: function(a, b, c, d, e) {
            this._currentFlip || (this._currentFlip = this.foldPageBasicStart(a, b, c, d, e));
            this._currentFlip && this._currentFlip.page == a && (this._currentFlip.x = b, this._currentFlip.y =
                c, this._currentFlip.page.data("holdedAt", {
                    x: b,
                    y: c
                }), this._currentFlip.corner = d, this.foldPageBasicStyles(this._currentFlip))
        },
        foldPageBasicStart: function(a, b, c, d, e) {
            var g = {};
            "number" === typeof a && (a = this.pages[a]);
            g.book = this;
            g.page = a;
            g.pageIndex = a.data("pageIndex");
            void 0 === e && (e = this.backPage(g.pageIndex));
            if (e && e.length) {
                g.back = e;
                var h = a.pageHeight;
                d || (d = "tl");
                a.data("holdedAt", {
                    x: b,
                    y: c
                });
                a.data("holdedCorner", d);
                e.css("zIndex", 1E5);
                a.data("foldPageBasic", !0);
                g.foldGradientWidth = this.foldGradientElem.width();
                g.foldShadowWidth = this.foldShadow.width();
                this.internalShadow.css("display", "none");
                this.foldShadow.css({
                    display: "none",
                    height: h,
                    transform: "",
                    top: a.top
                }).toggleClass("wowbook-shadow-fold-flipped", a.onRight);
                this.shadowContainer.css("display", "block");
                b = e.children().first();
                this.foldGradientContainer.appendTo(b).css({
                    width: g.foldGradientWidth,
                    height: h,
                    top: 0,
                    transform: "",
                    zIndex: 1E9
                });
                this.foldGradientElem.css({
                    left: 0,
                    height: h
                }).toggleClass("wowbook-fold-gradient-flipped", a.onRight);
                return g
            }
        },
        foldPageBasicStyles: function(a) {
            var b =
                a.page,
                c = a.back;
            x = a.x;
            y = a.y;
            var d = b.pageWidth,
                e = b.pageHeight,
                g = a.corner;
            g || (g = "tl");
            b.data("holdedAt", {
                x: x,
                y: y
            });
            b.data("holdedCorner", g);
            var h = (g = this.pageIsOnTheLeft(a.pageIndex)) ? x : d - x;
            0 > h && (h = 0);
            h > 2 * d && (h = 2 * d);
            var l = h / 2,
                q;
            g ? (q = "rect(-1000px " + d + "px " + e + "px " + l + "px)", e = "rect(-1000px " + d + "px " + e + "px " + (d - l) + "px)", h = b.left + (h - d)) : (q = "rect(-1000px " + (d - l) + "px " + e + "px -1000px)", e = "rect(-1000px " + l + "px " + e + "px -1000px)", h = c.left + (d - h + d));
            b.css("clip", q);
            c.css({
                clip: e,
                left: h,
                display: "block"
            });
            q = this.calculateOpacity(2 *
                l, 2 * d, this.shadowThreshold, 50);
            this.shadows && 0 < q ? (b = g ? b.left + l - a.foldShadowWidth : c.left + d - l + d, this.shadowContainer.css("opacity", q), this.foldShadow.css({
                left: b,
                display: "block"
            })) : this.foldShadow.css("display", "none");
            q = this.calculateOpacity(2 * l, 2 * d, this.foldGradientThreshold, 50);
            this.foldGradient && 0 < q ? (b = g ? d - l : l - a.foldGradientWidth, this.foldGradientContainer.css({
                opacity: q,
                left: b,
                display: "block"
            })) : this.foldGradientContainer.css("display", "none")
        },
        stopAnimation: function(a) {
            arguments.length || (a = !0);
            e(this).stop(!0, a);
            this.animating = !1;
            this.currentFlip && (this.currentFlip.finished = !0)
        },
        flip: function(a, b, c, d) {
            d || (d = e.isPlainObject(a) ? a : {});
            d.from || (d.from = []);
            d.to || (d.to = []);
            var f = this;
            if (!f.animating) {
                f.animating = !0;
                c || (c = d.page || f.holdedPage);
                var g = c.data("holded_info");
                c.data("holdedAt");
                var h = d.corner || c.data("holdedCorner"),
                    l = e.easing[d.easing] || d.easing || function(a) {
                        return 1 == a ? 1 : -Math.pow(2, -10 * a) + 1
                    };
                a = {
                    page: c,
                    back: d.back || f.holdedPageBack || f.backPage(c.pageIndex),
                    initialX: void 0 != d.from[0] ?
                        d.from[0] : g[0],
                    initialY: void 0 != d.from[1] ? d.from[1] : g[1],
                    finalX: void 0 != d.to[0] ? d.to[0] : a,
                    finalY: void 0 != d.to[1] ? d.to[1] : b,
                    corner: h || g[2],
                    duration: d.duration,
                    complete: function() {
                        f.animating = !1;
                        e.isFunction(d.complete) && d.complete()
                    },
                    easing: l,
                    arc: d.arc,
                    dragging: d.dragging,
                    start: e.now(),
                    finished: !1
                };
                a.deltaX = a.finalX - a.initialX;
                a.deltaY = a.finalY - a.initialY;
                this._animationData = {
                    from: {
                        x: a.initialX,
                        y: a.initialY
                    },
                    to: {
                        x: a.finalX,
                        y: a.finalY
                    },
                    dx: a.deltaX
                };
                void 0 == a.duration && (a.duration = this.turnPageDuration *
                    Math.abs(a.deltaX) / (2 * this.pageWidth));
                a.duration < this.opts.turnPageDurationMin && (a.duration = this.opts.turnPageDurationMin);
                !c.isHardPage && .4 < a.duration / this.turnPageDuration && this.playFlipSound();
                this.currentFlip = a
            }
        },
        rafCallback: function() {
            window.raf(this.callRAFCallback);
            this._zoomUpdateOnRAF();
            if (this.currentFlip && !this.currentFlip.finished) {
                var a = this.currentFlip,
                    b = (e.now() - a.start) / a.duration;
                1 <= b && (b = 1);
                a.x = a.initialX + a.deltaX * a.easing(b, a.duration * b, 0, 1, a.duration);
                a.y = a.initialY + a.deltaY *
                    a.easing(b, a.duration * b, 0, 1, a.duration);
                a.arc && (a.y -= (.5 - Math.abs(.5 - a.easing(b, a.duration * b, 0, 1))) * this.pageHeight / 10);
                a.dragging && (a.x = a.initialX + .2 * a.deltaX, a.y = a.initialY + .2 * a.deltaY, a.initialX = a.x, a.initialY = a.y, a.deltaX = a.finalX - a.initialX, a.deltaY = a.finalY - a.initialY, 1 > a.deltaX && 1 > a.deltaY && 1 == b);
                this.holdPage(a.page, a.x, a.y, a.corner, a.back);
                1 == b && (a.finished = !0, a.complete && a.complete())
            }
        },
        releasePages: function() {
            for (var a = 0, b = this.pages.length; a < b; a++) this.pages[a].data("holded") && this.releasePage(a)
        },
        releasePage: function(a, b, c, d) {
            "number" === typeof a && (a = this.pages[a]);
            var e = this,
                g = a.data("holdedAt"),
                h = a.data("holdedCorner");
            if (b && g) this.flip({
                from: [g.x, g.y],
                to: a.corners[h],
                page: a,
                easing: "linear",
                duration: 1E4,
                duration: d,
                complete: function() {
                    e.releasePage(a)
                }
            });
            else if (b = a.data("pageIndex"), void 0 === c && (c = this.holdedPageBack || this.backPage(b)), this.holdedPageBack = this.holdedPage = null, a.data({
                    holded_info: null,
                    holdedAt: null,
                    holdedCorner: null,
                    grabPoint: !1,
                    foldPageBasic: null,
                    holded: !1
                }), this.clipBoundaries &&
                !this.zoomed && (this.clipper.css("overflow", "hidden"), this.clipper.children(".wowbook-inner-clipper").css("overflow", "hidden")), this.shadowClipper.css("display", "none"), this.internalShadow.parent().hide(), this.foldGradientContainer.hide(), this.hardPageDropShadow.hide(), this.resetPage(a), c && c.length && (this.resetPage(c), c.hide()), this.foldShadow.removeClass("wowbook-shadow-fold-flipped").css({
                    transform: "",
                    left: ""
                }), this.foldGradientElem.removeClass("wowbook-fold-gradient-flipped").css("transform", ""),
                this.foldGradientContainer.css("transform", "").appendTo(this.pagesContainer), this.positionBookShadow(), this.opts.onReleasePage) this.opts.onReleasePage(this, b, a, c)
        },
        resetPage: function(a) {
            this._currentFlip = void 0;
            a.removeClass("wowbook-page-holded");
            this.resetCSS || (this.resetCSS = {
                transform: "",
                transformOrigin: "",
                clip: "auto",
                marginLeft: 0,
                marginTop: 0,
                filter: ""
            });
            var b = a.pageWidth,
                c = a.pageHeight;
            a.css(this.resetCSS).css({
                zIndex: a.data("zIndex"),
                width: b,
                height: c,
                left: a.onLeft ? 0 : this.pageWidth
            });
            this.setPagePosition(a);
            e.browser.msie && 9 > e.browser.version && a.attr("style", a.attr("style").replace(/clip\: [^;]+;/i, ""));
            a = e(".wowbook-page-content", a);
            a.css(this.resetCSS);
            n(a, b, c);
            this.hardPageShadow && this.hardPageShadow.hide()
        },
        gotoPage: function(a, b) {
            var c, d;
            if (!this.animating) {
                "string" === typeof a && "#" == a.charAt(0) && (a = this.selectorToPage(a));
                0 > a && (a = 0);
                a > this.pages.length - 1 && (a = this.pages.length - 1);
                if (this._singlePage) {
                    if (a == this.currentPage) return
                } else if (this.isOnPage(a)) return;
                if (!this.elem.is(":visible")) return this.showPage(a,
                    b), a;
                this._cantStopAnimation = !0;
                var e = a < this.currentPage;
                c = this.rtl ? a > this.currentPage : e;
                var g = this,
                    h = c ? g.leftPage() : g.rightPage();
                if (h) {
                    this.uncurl(!0);
                    var l, q;
                    c ? (l = this.leftPage(a), q = this.rightPage(a)) : (l = this.rightPage(a), q = this.leftPage(a));
                    if (this.closable && this.differentPageSizes && h.isCover != q.isCover) {
                        if (0 == h.pageIndex || 0 == q.pageIndex) this.showPage(1, !1);
                        else {
                            var k = this.pages.length - 1;
                            this.otherPage(k) || h.pageIndex != k && q.pageIndex != k || this.showPage(this.backPage(k).pageIndex, !1)
                        }
                        this.gotoPage(q.pageIndex)
                    } else {
                        var m =
                            q && q.is(":visible");
                        if (e)
                            for (e = h.pageIndex - 1; 0 <= e; e--) this.pages[e].css("display", "none");
                        else
                            for (e = h.pageIndex + 1, d = this.pages.length; e < d; e++) this.pages[e].css("display", "none");
                        l && (l.css("display", "block"), l.onLeft ? this.insideCoverLeft.css("display", "block") : this.insideCoverRight.css("display", "block"));
                        m && q.css("display", "block");
                        var n = a;
                        l = h.data("holdedAt");
                        m = h.data("holdedAt");
                        e = h.data("holdedCorner") || (c ? "tl" : "tr");
                        c ? (m = m || {
                            x: 0,
                            y: 0
                        }, c = 2 * g.pageWidth, d = "bl" != e ? 0 : h.pageHeight) : (m = m || {
                            x: h.pageWidth,
                            y: 0
                        }, c = -h.pageWidth, d = "br" != e ? 0 : h.pageHeight);
                        var p = "linear";
                        if (this.centeredWhenClosed && !this._singlePage && (h.isHardPage || q.isHardPage)) {
                            var k = this.pages.length - 1,
                                r = !this.rtl,
                                p = "easeOutCubic";
                            this.pageIsOnTheRight(this.currentPage) && !this.otherPage(this.currentPage) && (c += this.pageWidth / 2, a != (r ? k : 0) || this.otherPage(a) || (c += this.pageWidth / 2));
                            this.pageIsOnTheLeft(this.currentPage) && !this.otherPage(this.currentPage) && (c -= this.pageWidth / 2, a != (r ? 0 : k) || this.otherPage(a) || (c -= this.pageWidth / 2))
                        }
                        if (this._singlePage) {
                            if (this.isOnPage(a)) return this.animating = !0, this.slideX(this.pageIsOnTheLeft(a) ? 0 : -this.pageWidth, function() {
                                g._cantStopAnimation = !1;
                                g.animating = !1;
                                g.showPage(n, b)
                            }), a;
                            this.slideX(this.pageIsOnTheLeft(a) ? 0 : -this.pageWidth, function() {
                                g.showPage(n, b)
                            })
                        }
                        g.flip({
                            from: [m.x, m.y],
                            to: [c, d],
                            easing: p,
                            arc: !l,
                            page: h,
                            back: q,
                            corner: e,
                            complete: function() {
                                g._cantStopAnimation = !1;
                                g.releasePage(h, !1);
                                g.showPage(n, b)
                            }
                        });
                        return a
                    }
                }
            }
        },
        gotoDirection: function(a, b) {
            void 0 == b && (b = this.currentPage);
            "left" == a && (a = -1);
            "right" == a && (a = 1);
            var c = a * (this._singlePage ? 1 :
                2);
            this.rtl && (c = -c);
            return this.gotoPage(b + c)
        },
        gotoLeft: function(a) {
            return this.gotoDirection("left", a)
        },
        gotoRight: function(a) {
            return this.gotoDirection("right", a)
        },
        back: function() {
            return this.gotoPage(this.currentPage - (this._singlePage ? 1 : 2))
        },
        advance: function() {
            return this.gotoPage(this.currentPage + (this._singlePage ? 1 : 2))
        },
        leftPage: function(a) {
            void 0 === a && (a = this.currentPage);
            return this.pages[this.leftPageIndex(a)] || null
        },
        leftPageIndex: function(a) {
            if (null != a) {
                this.pageIsOnTheRight(a) && (a += this.rtl ?
                    1 : -1);
                if (0 > a || a > this.pages.length - 1) a = null;
                return a
            }
        },
        rightPage: function(a) {
            void 0 === a && (a = this.currentPage);
            return this.pages[this.rightPageIndex(a)] || null
        },
        rightPageIndex: function(a) {
            if (null != a) {
                this.pageIsOnTheLeft(a) && (a += this.rtl ? -1 : 1);
                if (0 > a || a > this.pages.length - 1) a = null;
                return a
            }
        },
        pageIsOnTheRight: function(a) {
            return !this.pageIsOnTheLeft(a)
        },
        pageIsOnTheLeft: function(a) {
            a = !(a % 2);
            this.closable && (a = !a);
            this.rtl && (a = !a);
            return a
        },
        otherPage: function(a) {
            var b = this.pageIsOnTheLeft(a) ? 1 : -1;
            this.rtl &&
                (b = -b);
            a += b;
            if (0 > a || a > this.pages.length - 1) a = null;
            return a
        },
        isOnPage: function(a) {
            return "number" === typeof a && (a === this.currentPage || a === this.otherPage(this.currentPage))
        },
        backPage: function(a) {
            if (!this.pages[a]) return null;
            var b = a % 2 ? 1 : -1;
            a += this.closable ? -b : b;
            return this.pages[a]
        },
        pageBelow: function(a) {
            a = parseInt(a, 10);
            if (a != a) return null;
            a += this.pageIsOnTheLeft(a) != this.rtl ? -2 : 2;
            if (0 > a || a > this.pages.length - 1) a = null;
            return a
        },
        pageType: function(a) {
            a = "number" === typeof a ? this.pages[a] : a;
            return a.isHardPage ?
                "hard" : a.find(".wowbook-page-content.wowbook-basic-page").length ? "basic" : "soft"
        },
        calculateOpacity: function(a, b, c, d) {
            if (a <= c || a >= b - c) return 0;
            if (a >= d && a <= b - d) return 1;
            a > d && (a = b - a);
            return (a - c) / (d - c)
        },
        startSlideShow: function() {
            this.slideShowRunning = !0;
            this.advanceAfterTimeout(this.slideShowDelay);
            this.toggleControl("slideshow", !0)
        },
        advanceAfterTimeout: function(a) {
            var b = this;
            this.slideShowTimer = setTimeout(function() {
                if (b.animating || b.holdedPage) b.advanceAfterTimeout(100);
                else {
                    var a = b.isOnPage(b.pages.length -
                        1);
                    b.opts.slideShowLoop && a ? b.gotoPage(0) : b.advance();
                    b.opts.slideShowLoop || !a ? b.advanceAfterTimeout(b.slideShowDelay + b.turnPageDuration) : b.stopSlideShow()
                }
            }, a)
        },
        stopSlideShow: function(a) {
            clearTimeout(this.slideShowTimer);
            this.slideShowTimer = void 0;
            this.slideShowRunning = !1;
            a || this.toggleControl("slideshow", !1)
        },
        toggleSlideShow: function() {
            this.slideShowRunning ? this.stopSlideShow() : this.startSlideShow()
        },
        findSections: function(a) {
            a && (this.sectionDefinition = a);
            var b = this.sectionDefinition;
            a = [];
            var c;
            "string" ===
            typeof b && (c = b, b = [], e(c, this.elem).each(function(a, c) {
                b.push(["#" + c.id, e(c).html()])
            }));
            if (e.isArray(b)) {
                for (var d = 0, f = b.length; d < f; d++) {
                    c = b[d];
                    if ("string" === typeof c) try {
                        c = [c, e(c, this.elem).html()]
                    } catch (g) {
                        continue
                    }
                    try {
                        c[2] = this.selectorToPage(c[0])
                    } catch (g) {
                        continue
                    }
                    void 0 !== c[2] && a.push({
                        id: c[0],
                        title: c[1],
                        page: c[2]
                    })
                }
                a = a.sort(function(a, b) {
                    return a.page - b.page
                })
            }
            return this.sections = a
        },
        pageToSection: function(a) {
            for (var b = this.sections, c, d = 0, e = b.length; d < e && !(b[d].page > a); d++) c = b[d];
            return c
        },
        currentSection: function() {
            return this.pageToSection(this.currentPage)
        },
        fillToc: function(a, b) {
            var c = e(a || this.opts.toc),
                d, f, g = "";
            if (0 !== c.length) {
                d = this.sections;
                "undefined" === typeof b && (b = this.opts.tocTemplate);
                b || (g = c.is("UL, OL") ? "<li>" : "<div>", b = '<a href="${link}">${section}</a>');
                for (var h = 0, l = d.length; h < l; h++) f = d[h], f = b.replace(/\$\{link\}/g, "#" + this.id + "/" + f.id.substr(1)).replace(/\$\{section\}/g, f.title).replace(/\$\{page\}/g, f.page), e(f).appendTo(c).wrap(g)
            }
        },
        createToc: function(a) {
            a = this.opts.toc ||
                a || [];
            var b = this.tocContainer = e("<div class='wowbook-toc' style='display:none'>").prependTo(e(this.opts.tocParent || "body"));
            b.append("<h1>" + this.opts.tocHeader + "<button class='wowbook-close'>&#10005;</button></h1>");
            this.controllify({
                toc: b.find(".wowbook-close")
            });
            for (var b = e("<ul class='wowbook-toc-items'>").appendTo(b), c = 0, d = a.length; c < d; c++) this.createTocItem(a[c][0], a[c][1]).appendTo(b);
            this.setStyle(this.opts.styles || this.opts.style)
        },
        createTocItem: function(a, b) {
            var c = this.opts.tocItemTemplate ||
                '<li class="wowbook-toc-item"><a href="${link}">${title}<span class="page">${page}</span></a></li>',
                d = "";
            e.isNumeric(b) && (d = b, b = this.pageToLocationHash(b));
            c = c.replace(/\$\{link\}/g, b).replace(/\$\{title\}/g, a).replace(/\$\{page\}/g, d);
            return e(c)
        },
        destroyToc: function() {
            this.tocContainer && this.tocContainer.remove();
            this.tocContainer = null
        },
        showToc: function(a) {
            this.tocContainer && this.tocContainer.length || this.createToc();
            this.tocContainer.fadeIn(a)
        },
        hideToc: function(a) {
            this.tocContainer.fadeOut(a)
        },
        toggleToc: function(a) {
            e(this.tocContainer).is(":visible") ? this.hideToc(a) : this.showToc(a)
        },
        locationHashToPage: function(a, b) {
            void 0 === a && (a = window.location.hash);
            if (a == "#" + this.id + "/") return 0;
            a = a.slice(1).split("/");
            if (a[0] === this.id) {
                if (1 === a.length) return 0;
                var c = parseInt(a[1]);
                if (!isNaN(c)) return Math.max(c - 1, 0);
                c = this.selectorToPage("#" + a[1]);
                if (void 0 === c) return 0;
                isNaN(a[2]) || (c += Math.max(parseInt(a[2]) - 1, 0));
                return +c
            }
        },
        pageToLocationHash: function(a) {
            var b = "",
                c = a + 1;
            if (a = this.pageToSection(a)) b +=
                "/" + a.id.replace("#", ""), c -= a.page;
            1 < c && (b += "/" + c);
            return "#" + this.id + (b || "/")
        },
        selectorToPage: function(a) {
            a = e(a, this.elem).closest(".wowbook-page");
            if (a.length) return +a.data("pageIndex")
        },
        getLocationHash: function() {
            return window.location.hash.slice(1)
        },
        locationEndsInHash: function(a) {
            void 0 === a && (a = window.location.href);
            return a.lastIndexOf("#") == a.length - 1
        },
        zoomSetup: function() {
            this._zoomOffset = {
                dx: 0,
                dy: 0
            };
            this._cssZoom = this._cssZoom || 1;
            this.zoomLevel = 1;
            this.detectBestZoomMethod();
            this.zoomTouchSupport();
            this.toggleControl("zoomIn", this.zoomLevel == this.zoomMax);
            this.toggleControl("zoomOut", this.zoomLevel == this.zoomMin);
            this.toggleControl("zoomReset", 1 == this.zoomLevel)
        },
        _zoomUpdateOnRAF: function() {
            if (this._zoomDataRAF) {
                var a = e.extend({}, this._zoomDataRAF.options),
                    b = this._zoomDataRAF.options.offset;
                if (b) {
                    var c = this._zoomOffset,
                        d = b.dx - c.dx,
                        f = b.dy - c.dy;
                    a.offset = {
                        dx: c.dx + .2 * d,
                        dy: c.dy + .2 * f
                    }
                }
                c = this._zoomDataRAF.level || this.zoomLevel;
                c != this.zoomLevel && (c = this.zoomLevel + .2 * (c - this.zoomLevel));
                a.transform = !0;
                this._zoom(c, a);
                b && 1 > Math.abs(d) && 1 > Math.abs(f) && 1 > Math.abs(this.zoomLevel - c) && (this._zoomDataRAF.callback && this._zoomDataRAF.callback.call(this), this._zoomDataRAF = null)
            }
        },
        _zoom: function(a, b) {
            b || (b = {});
            var c = void 0 != b.x ? b.x : this.pageWidth * this.currentScale,
                d = b.y || 0;
            this._zoomOffset = b.offset || this.zoomFocusOffset(a, c, d);
            this.zoomLevel = a;
            var c = b.transform || this.opts.zoomUsingTransform,
                f = a * this.currentScale,
                d = e.browser.ie7 ? 1 : c ? this._cssZoom : f,
                g = this.zoomWindow,
                h = this.zoomContent,
                l = e(this.zoomBoundingBox),
                k = l.outerWidth(),
                m = l.outerHeight(),
                n = g.offset();
            g.position();
            l = l[0] !== window ? l.offset() : {
                left: l.scrollLeft(),
                top: l.scrollTop()
            };
            g.css({
                width: k,
                height: m
            });
            k = l.left - n.left;
            n = l.top - n.top;
            k && (k += parseFloat(g.css("marginLeft")), g.css("marginLeft", k), h.marginLeft = k);
            n && (n += parseFloat(g.css("marginTop")), g.css("marginTop", n), h.marginTop = n);
            g = "";
            n = this._zoomOffset.dx / d;
            k = this._zoomOffset.dy / d;
            e.wowBook.support.transform && (n || k) ? g = e.wowBook.utils.translate(n, k) : h.css({
                left: n,
                top: k
            });
            c ? (f /= d, g += this.opts.useScale3d ?
                "scale3d(" + f + "," + f + ",1)" : "scale(" + f + ")") : (this._cssZoom = f, h.css("zoom", f), h.css("marginLeft", -h.marginLeft / d), h.css("marginTop", -h.marginTop / d));
            e.wowBook.support.transform && h.css("transform", g);
            1 !== this.zoomLevel ? this.zoomed || (h.css("marginLeft", -h.marginLeft / d), h.css("marginTop", -h.marginTop / d), c && h.css("transformOrigin", "0 0"), this.elem.find("img").each(function() {
                var a = e(this);
                a.data("wowbook-draggable-before-zoom", a.attr("draggable"));
                a.attr("draggable", !1)
            })) : this.zoomFinished();
            this.zoomed =
                1 !== a;
            h.toggleClass("wowbook-draggable", this.zoomed);
            this.toggleControl("zoomIn", this.zoomLevel == this.zoomMax);
            this.toggleControl("zoomOut", this.zoomLevel == this.zoomMin);
            this.toggleControl("zoomReset", 1 == this.zoomLevel)
        },
        zoom: function(a, b, c) {
            this.uncurl(!0);
            for (var d = 0, f = this.pages.length; d < f; d++)
                if (this.pages[d].data("holdedAt")) return;
            e.isPlainObject(b) && (c = b, b = c.duration);
            c || (c = {});
            if (a <= this.zoomMin && !c.resetting) return this.zoomReset(b, c);
            a > this.zoomMax && (a = this.zoomMax);
            if (a !== this.zoomLevel ||
                c.force)
                if (void 0 == b && (b = this.opts.zoomDuration), 0 == b) {
                    if (this._zoom(a, c), c.callback && c.callback.apply(this), this.onZoom) this.onZoom(this)
                } else {
                    d = !this.opts.zoomUsingTransform && e.wowBook.support.transform;
                    this._zoomAnimating && (e(this).stop(), d && this.zoomContent.css("transform", ""));
                    this._zoomAnimating = this.zoomLevel;
                    var g = this,
                        f = c.x,
                        h = c.y || 0;
                    void 0 == f && (f = (this._singlePage ? this.pageWidth / 2 : this.pageWidth) * this.currentScale);
                    var l = {
                            x: f,
                            y: h,
                            offset: {
                                dx: 0,
                                dy: 0
                            }
                        },
                        k = e.extend({
                            dx: 0,
                            dy: 0
                        }, this._zoomOffset),
                        f = c.offset || this.zoomFocusOffset(a, f, h),
                        m = f.dx - k.dx,
                        n = f.dy - k.dy;
                    d && (l.transform = !0, this._isMobile && (this.leftPage() && this.leftPage().css("-webkit-transform", "translateZ(0)"), this.rightPage() && this.rightPage().css("-webkit-transform", "translateZ(0)")));
                    e(this).animate({
                        _zoomAnimating: a
                    }, {
                        duration: b,
                        easing: c.easing || this.opts.zoomEasing,
                        complete: function() {
                            g._zoomAnimating = !1;
                            g._zoom(a);
                            c.callback && c.callback.apply(this);
                            if (g.onZoom) g.onZoom(g)
                        },
                        step: function(a, b) {
                            l.offset.dx = k.dx + m * b.pos;
                            l.offset.dy =
                                k.dy + n * b.pos;
                            g._zoom(a, l)
                        }
                    })
                }
        },
        zoomFinished: function() {
            this.zoomWindow.css({
                overflow: "visible",
                width: this.zoomContent.width() * this.currentScale,
                height: this.zoomContent.height() * this.currentScale,
                marginLeft: 0,
                marginTop: 0
            });
            this.zoomContent.css({
                left: 0,
                top: 0,
                marginLeft: 0,
                marginTop: 0
            });
            this._zoomOffset = {
                dx: 0,
                dy: 0
            };
            this.elem.find("img").each(function() {
                var a = e(this);
                void 0 == a.data("wowbook-draggable-before-zoom") ? a.removeAttr("draggable") : a.attr("draggable", a.data("wowbook-draggable-before-zoom"))
            })
        },
        zoomReset: function(a, b) {
            e.isPlainObject(a) && (b = a, a = b.duration);
            b || (b = {});
            this._zoomDataRAF = null;
            b.offset = {
                dx: 0,
                dy: 0
            };
            b.resetting = !0;
            b.force = !0;
            b.callback = function() {
                this.zoomContent.css({
                    left: 0,
                    top: 0
                });
                this.zoomed = !1
            };
            this.zoom(1, a, b)
        },
        zoomIn: function(a, b) {
            e.isPlainObject(a) && (b = a, a = void 0);
            this.zoom(this.zoomLevel + (a || this.zoomStep), b)
        },
        zoomOut: function(a, b) {
            e.isPlainObject(a) && (b = a, a = void 0);
            this.zoom(this.zoomLevel - (a || this.zoomStep), b)
        },
        zoomFocusOffset: function(a, b, c, d, f) {
            d || (d = this._zoomOffset || {
                dx: 0,
                dy: 0
            });
            d = e.extend({
                dx: 0,
                dy: 0
            }, d);
            var g = d.dx || 0,
                h = d.dy || 0;
            f = a / (f || this.zoomLevel);
            b -= g;
            c -= h;
            a = b * f;
            f *= c;
            d.dx = g - (a - b);
            d.dy = h - (f - c);
            return {
                dx: g - (a - b),
                dy: h - (f - c)
            }
        },
        zoomTouchSupport: function() {
            if (this.opts.touchEnabled) {
                if (e.browser.ie8mode || e.browser.ie7) return this.zoomDragSupportForIE();
                var a = this,
                    b, c, d;
                a._hammer = new Hammer(a.zoomContent[0], a.opts.touch);
                var f = a._hammer;
                f.on("panstart pinchstart", function(b) {
                    a.zoomContent.addClass("wowbook-dragging")
                });
                f.on("hammer.input", function(b) {
                    if (a.zoomContent.hasClass("wowbook-draggable") &&
                        (e(b.target).is("img") && "mousedown" == b.srcEvent.type && b.preventDefault(), b.isFinal && a.zoomContent.hasClass("wowbook-dragging"))) {
                        c = d = null;
                        a.zoomContent.removeClass("wowbook-dragging");
                        b = a.zoomLevel;
                        var f = a._zoomDataRAF,
                            l = f ? f.level : b;
                        l < a.zoomMin || l == a.zoomMin && (a._zoomOffset.dx || a._zoomOffset.dy) ? f ? f.callback = function() {
                            a.zoomReset()
                        } : a.zoomReset() : a._zoom(b, {
                            force: !0,
                            offset: a._zoomOffset
                        })
                    }
                });
                f.on("panstart panmove", function(b) {
                    a.zoomed && (b.preventDefault(), d = null, c || (c = {
                        offset: e.extend({}, a._zoomOffset),
                        pageX: b.center.x,
                        pageY: b.center.y
                    }), a._zoomDataRAF = {
                        level: a.zoomLevel,
                        options: {
                            force: !0,
                            offset: {
                                dx: c.offset.dx + (b.center.x - c.pageX),
                                dy: c.offset.dy + (b.center.y - c.pageY)
                            }
                        }
                    })
                });
                f.on("pinchmove pinchstart", function(f) {
                    f.preventDefault();
                    c = null;
                    var h = f.center.x,
                        l = f.center.y;
                    if (!d) {
                        if (a.currentFlip && !a.currentFlip.finished) return;
                        b = a.elem.offset();
                        d = {
                            level: a.zoomLevel,
                            pageX: h,
                            pageY: l,
                            x: h - b.left,
                            y: l - b.top,
                            offset: e.extend({}, a._zoomOffset),
                            useTransform: a.opts.zoomUsingTransform
                        }
                    }
                    f = d.level * f.scale;
                    f > a.zoomMax &&
                        (f = a.zoomMax);
                    var k = a.zoomFocusOffset(f, d.x, d.y, d.offset, d.level);
                    k.dx += h - d.pageX;
                    k.dy += l - d.pageY;
                    a._zoomDataRAF = {
                        level: f,
                        options: {
                            force: !0,
                            offset: k
                        }
                    }
                });
                a.opts.pinchToZoom && (f.get("pinch").set({
                    enable: !0
                }), f.get("pinch").recognizeWith("pan"))
            }
        },
        zoomDragSupportForIE: function() {
            var a = this,
                b, c = function(c) {
                    a._zoomDataRAF = {
                        level: a.zoomLevel,
                        options: {
                            force: !0,
                            offset: {
                                dx: b.offset.dx + (c.pageX - b.pageX),
                                dy: b.offset.dy + (c.pageY - b.pageY)
                            }
                        }
                    };
                    return !1
                },
                d = function(b) {
                    b = a.zoomLevel;
                    (b < a.zoomMin || b == a.zoomMin && (a._zoomOffset.dx ||
                        a._zoomOffset.dy)) && a.zoomReset();
                    e(document).unbind("mousemove.wowbook", c);
                    e(document).unbind("mouseup.wowbook", d)
                };
            a.zoomContent.bind("mousedown.wowbook", function(f) {
                if (a.zoomed) return b = {
                    offset: e.extend({}, a._zoomOffset),
                    pageX: f.pageX,
                    pageY: f.pageY
                }, e(document).bind("mousemove.wowbook", c).bind("mouseup.wowbook", d), !1
            })
        },
        detectBestZoomMethod: function(a, b, c) {
            void 0 === a && (a = e.wowBook.support.transform);
            void 0 === c && (c = e.browser.ie8mode);
            a = e.browser.chrome || e.browser.webkit || e.browser.safari || e.browser.opera ||
                c || !a;
            this.opts.zoomUsingTransform = !a;
            return a ? "zoom" : "transform"
        },
        setupFullscreen: function() {
            if (A) {
                var a = this,
                    b, c = "fullscreenerror mozfullscreenerror webkitfullscreenerror MSFullscreenError ";
                b = "fullscreenchange mozfullscreenchange webkitfullscreenchange MSFullscreenChange ".replace(/ /g, ".wowbook ");
                c = c.replace(/ /g, ".wowbook ");
                this._fullscreenChangeHandler = function() {
                    var b = !!D();
                    e(a.opts.fullscreenElement).toggleClass("fullscreen wowbook-fullscreen-fix", b);
                    a.elem.toggleClass("fullscreen", b);
                    a.toggleControl("fullscreen",
                        b)
                };
                e(document).on(b, this._fullscreenChangeHandler);
                this._fullscreenErrorHandler = function() {
                    a.opts.onFullscreenError && a.opts.onFullscreenError.apply(this, arguments)
                };
                e(document).on(c, this._fullscreenErrorHandler)
            } else e("html").addClass("no-fullscreen")
        },
        enterFullscreen: function(a) {
            a = e(a || this.opts.fullscreenElement)[0];
            A.call(a || B)
        },
        exitFullscreen: function() {
            F.call(m)
        },
        toggleFullscreen: function() {
            D() ? this.exitFullscreen() : this.enterFullscreen()
        },
        positionBookShadow: function() {
            var a = this.pages.length,
                b = !(!this.opts.bookShadow || !a || 3 > a && this.holdedPage);
            this.bookShadow.toggle(b);
            if (b) {
                var b = this.pageWidth,
                    c = this.holdedPageBack,
                    d = !!c && c.onRight && c.pageIndex == (this.rtl ? a - 1 : 0),
                    c = !!c && c.onLeft && c.pageIndex == (this.rtl ? 0 : a - 1),
                    a = !this.leftPage() || d,
                    c = !this.rightPage() || c,
                    d = a != c;
                if (a && c) this.bookShadow.hide();
                else {
                    var c = this.opts.zoomUsingTransform ? this.currentScale * this.zoomLevel : 1,
                        e = this.elem.is(":visible") ? this.pagesContainer.position().left : parseFloat(this.pagesContainer.css("left")) || 0;
                    this.translate(this.bookShadow, (a ? b : 0) + e / c, 0);
                    this.bookShadow.css({
                        width: d ? b : 2 * b
                    })
                }
            }
        },
        playFlipSound: function() {
            if (this.flipSound) {
                var a = this.opts.onPlayFlipSound;
                e.isFunction(a) && !1 === a(this) || (this.audio || (this.audio = this.createAudioPlayer()), this.audio && this.audio.play && this.audio.play())
            }
        },
        toggleFlipSound: function(a) {
            arguments.length || (a = !this.flipSound);
            this.flipSound = a;
            this.toggleControl("flipSound", !a)
        },
        createAudioPlayer: function(a, b) {
            a || (a = this.opts.flipSoundPath);
            b || (b = this.opts.flipSoundFile);
            for (var c = [], d = 0, f = b.length; d <
                f; d++) c.push('<source src="' + a + b[d] + '">');
            return e("<audio preload>" + c.join("") + "</audio>")[0]
        },
        _untouch: function(a) {
            return a.originalEvent.touches && a.originalEvent.touches[0] || a
        },
        touchSupport: function() {
            var a = this;
            a.elem.bind("touchstart.wowbook", function(b) {
                var c = b.originalEvent.touches;
                1 < c.length || (a._touchStarted = {
                    x: c[0].pageX,
                    y: c[0].pageY,
                    timestamp: b.originalEvent.timeStamp,
                    inHandle: e(b.target).hasClass("wowbook-handle")
                }, a._touchStarted.inHandle && a.pageEdgeDragStart(a._untouch(b)))
            });
            e(document).on("touchmove.wowbook",
                function(b) {
                    if (a._touchStarted) {
                        var c = b.originalEvent.touches;
                        a._touchEnded = {
                            x: c[0].pageX,
                            y: c[0].pageY,
                            timestamp: b.originalEvent.timeStamp
                        };
                        if (a._touchStarted.inHandle) return a.pageEdgeDrag(a._untouch(b));
                        a.opts.allowDragBrowserPageZoom && 1 != document.documentElement.clientWidth / window.innerWidth || b.preventDefault()
                    }
                });
            e(document).on("touchend.wowbook touchcancel.wowbook", function(b) {
                if (a._touchStarted) {
                    !a._touchEnded && e(b.target).hasClass("wowbook-handle") && (b = e(b.target).data("corner"), "r" === b && a.advance(),
                        "l" === b && a.back());
                    var c = a._touchStarted,
                        d = a._touchEnded || a._touchStarted;
                    a._touchStarted = null;
                    a._touchEnded = null;
                    if (!a.zoomed) {
                        if (c.inHandle) return a.pageEdgeDragStop({
                            pageX: d.x
                        }), !1;
                        b = d.x - c.x;
                        var f = d.y - c.y,
                            c = d.timestamp - c.timestamp;
                        if (!(20 > Math.abs(b) || 200 < c) && Math.abs(b) > Math.abs(f)) return 0 > b ? a.advance() : a.back(), !1
                    }
                }
            })
        },
        pageEdgeDragStart: function(a) {
            if (!this.zoomed) {
                if (this.animating && !this.curledPage || !e(a.target).hasClass("wowbook-handle")) return !1;
                var b = this,
                    c = b.origin.offset();
                this.opts.zoomUsingTransform ||
                    (c.left *= this.currentScale);
                b.elem.addClass("wowbook-unselectable");
                b.mouseDownAtLeft = (a.pageX - c.left) / this.currentScale < b.pageWidth;
                b.pageGrabbed = b.mouseDownAtLeft ? b.leftPage() : b.rightPage();
                if (!b.pageGrabbed) return !1;
                this.uncurl(!0);
                b.pageGrabbedOffset = b.pageGrabbed.offset();
                b._dragging = !0;
                this.opts.zoomUsingTransform && (b.pageGrabbedOffset.left /= this.currentScale, b.pageGrabbedOffset.top /= this.currentScale);
                c = a.pageX / this.currentScale - this.pageGrabbedOffset.left;
                a = a.pageY / this.currentScale - this.pageGrabbedOffset.top;
                this.stopAnimation(!1);
                var d = b.mouseDownAtLeft ? "l" : "r";
                this.holdPage(this.pageGrabbed, c, a);
                this.flip(c, a, this.pageGrabbed, {
                    corner: d
                });
                e(document).bind("mousemove.wowbook", function(a) {
                    return b.pageEdgeDrag(a)
                }).bind("mouseup.wowbook", function(a) {
                    return b.pageEdgeDragStop(a)
                });
                return !1
            }
        },
        pageEdgeDrag: function(a) {
            if (!this._dragging) return !1;
            var b = a.pageX / this.currentScale - this.pageGrabbedOffset.left;
            a = a.pageY / this.currentScale - this.pageGrabbedOffset.top;
            var c = this.mouseDownAtLeft ? "l" : "r";
            this.stopAnimation(!1);
            this.flip(b, a, this.pageGrabbed, {
                corner: c,
                dragging: !0
            });
            return !1
        },
        pageEdgeDragStop: function(a) {
            if (!this._dragging) return !1;
            var b = this.origin.offset();
            this.opts.zoomUsingTransform || (b.left *= this.currentScale);
            var c = (a.pageX - b.left) / this.currentScale;
            a = (a.pageX - b.left) / this.currentScale < this.pageWidth;
            this.elem.removeClass("wowbook-unselectable");
            this._cantStopAnimation || this.stopAnimation(!1);
            this._singlePage ? this.pageGrabbed.onLeft ? c > this.pageWidth / 2 ? this.pageGrabbed.pageIndex == this.currentPage ? this.rtl ?
                this.advance() : this.back() : (c = this.pageGrabbed.pageIndex + (this.rtl ? 1 : -1), this.gotoPage(c)) : this.releasePage(this.pageGrabbed, !0) : c < this.pageWidth + this.pageWidth / 2 ? this.pageGrabbed.pageIndex == this.currentPage ? this.rtl ? this.back() : this.advance() : (c = this.pageGrabbed.pageIndex + (this.rtl ? -1 : 1), this.gotoPage(c)) : this.releasePage(this.pageGrabbed, !0) : this.mouseDownAtLeft && !a ? this.rtl ? this.advance() : this.back() : !this.mouseDownAtLeft && a ? this.rtl ? this.back() : this.advance() : this.releasePage(this.pageGrabbed, !0);
            this._dragging = !1;
            e(document).unbind("mousemove.wowbook mouseup.wowbook")
        },
        curl: function(a, b) {
            if (!(this.curledPage || this.holdedPage || this.zoomed)) {
                void 0 == a && (a = this.currentPage);
                if ("number" == typeof a || "string" == typeof a) a = this.pages[+a];
                if (a && !a.isCurled) {
                    a.isCurled = !0;
                    this.curledPage = a;
                    var c = this.pageIsOnTheLeft(a.pageIndex),
                        d = c ? 0 : this.pageWidth,
                        e = b ? this.pageHeight - 1 : 2;
                    this.flip({
                        from: [d, e],
                        to: [d + this.opts.curlSize * (c ? 1 : -1), e + this.opts.curlSize * (b ? -1 : 1)],
                        corner: (b ? "b" : "t") + (c ? "l" : "r"),
                        page: a,
                        duration: 400
                    })
                }
            }
        },
        uncurl: function(a, b) {
            if (this.curledPage) {
                1 == a && (b = !0, a = void 0);
                void 0 == a && (a = this.curledPage || this.currentPage);
                if ("number" == typeof a || "string" == typeof a) a = this.pages[+a];
                a.isCurled && (this.stopAnimation(!1), this.releasePage(a, !b, void 0, 400), a.isCurled = !1, this.curledPage = null)
            }
        },
        initThumbnails: function() {
            var a = this.opts;
            this.thumbnails = [];
            var b = this.thumbnailsContainer = e("<div class='wowbook-thumbnails'>").append("<div class='wowbook-wrapper'><a class='wowbook-back wowbook-button wowbook-control wowbook-control-back'/><div class='wowbook-clipper'><ul></ul></div><a class='wowbook-next wowbook-button wowbook-control wowbook-control-next' /></div>").css("display",
                "none").css("transform", "translateZ(0)").appendTo(e(a.thumbnailsParent));
            this.thumbnailsList = b.find("ul");
            this.thumbnailsClipper = b.find(".wowbook-clipper");
            a.thumbnailsContainerWidth && b.width(a.thumbnailsContainerWidth);
            a.thumbnailsContainerHeight && b.height(a.thumbnailsContainerHeight);
            var c = a.thumbnailsPosition;
            if ("left" == c || "right" == c) a.thumbnailsVertical = !0, "right" == c && b.css({
                position: "absolute",
                left: "auto",
                right: "0px"
            });
            if ("top" == c || "bottom" == c) a.thumbnailsVertical = !1, "bottom" == c && b.css({
                position: "absolute",
                top: "auto",
                bottom: "0px"
            });
            b.addClass(a.thumbnailsVertical ? "wowbook-vertical" : "wowbook-horizontal");
            b.toggleClass("wowbook-closable", this.closable);
            var d = this,
                f = a.thumbnailsVertical ? "height" : "width";
            this.thumbnailsBackButton = b.find(".wowbook-back.wowbook-button").click(function() {
                d._moveThumbnailsList(d.thumbnailsClipper[f]())
            });
            this.thumbnailsNextButton = b.find(".wowbook-next.wowbook-button").click(function() {
                d._moveThumbnailsList(-d.thumbnailsClipper[f]())
            });
            this.thumbnailsClipper.css("transform",
                "translateZ(0)");
            0 == this.scrollBarWidth() && this.thumbnailsClipper.css("overflow", "auto")
        },
        destroyThumbnails: function() {
            this.thumbnailsContainer && this.thumbnailsContainer.remove();
            this.thumbnails = this._thumbnailsPos = this.thumbnailsContainer = null
        },
        scrollBarWidth: function() {
            var a = e("<div style='display: inline-block;position: absolute;left:-1000px;'>Hi!</div>").appendTo("body"),
                b = a.width();
            a.css("overflow", "scroll");
            var c = a.width();
            a.remove();
            return c - b
        },
        createThumbnails: function() {
            this.thumbnails ||
                this.initThumbnails();
            var a, b = this.thumbnailConfig();
            this.thumbnails = [];
            for (var c = 0, d = this.pages.length; c < d; c++) a = this.createThumbnail(c, b), this.thumbnailsList.append(a), this.thumbnails.push(a);
            if (this.rtl)
                for (a = this.thumbnailsList.children(), a.eq(0).addClass("wowbook-right").removeClass("wowbook-left"), c = 1, d = a.length; c < d; c += 2) a.eq(c).insertAfter(a.eq(c + 1));
            c = this.thumbnailsContainer;
            c.width() || c.width(2 * b.width);
            this.setStyle(this.opts.styles || this.opts.style)
        },
        thumbnailConfig: function() {
            var a = {},
                b = e('<div class="wowbook-thumbnail" style="display:none;position:absolute;line-height:0px;font-size:0px;">').prependTo(this.thumbnailsContainer),
                c = this.opts.thumbnailHeight || (2 >= b.height() ? 0 : b.height()),
                d = this.opts.thumbnailWidth || b.width(),
                f = d / this.pageWidth || c / this.pageHeight || this.opts.thumbnailScale;
            b.remove();
            this.thumbnailScale = f;
            a.width = d || Math.floor(this.pageWidth * f);
            a.height = c || Math.floor(this.pageHeight * f);
            a.cloneCSS = {
                display: "block",
                left: 0,
                top: 0,
                position: "relative",
                transformOrigin: "0 0"
            };
            e.wowBook.support.transform ? a.cloneCSS.transform = "scale(" + f + ")" : a.cloneCSS.zoom = f;
            this.differentPageSizes && (b = this.opts.pageWidth ? f * this.pageWidth / this.opts.pageWidth : this.opts.pageHeight ? f * this.pageHeight / this.opts.pageHeight : this.opts.thumbnailScale, a.scaleInternalPage = e.wowBook.support.transform ? {
                transform: "scale(" + b + ")"
            } : {
                zoom: b
            });
            return a
        },
        createThumbnail: function(a, b) {
            var c = this.pages[a];
            if (c) {
                b || (b = this.thumbnailConfig());
                var d = e('<li class="wowbook-thumbnail"><div class="wowbook-overlay">').addClass(this.pageIsOnTheLeft(a) ?
                    "wowbook-left" : "wowbook-right").css({
                    width: b.width,
                    height: b.height
                });
                if (this.opts.thumbnailsSprite) d.css("background", "url(" + this.opts.thumbnailsSprite + ") no-repeat 0px -" + a * b.height + "px");
                else {
                    var f = c.clone();
                    f.hasClass("wowbook-page-holded") && (this.resetPage(f), f.find(".wowbook-fold-gradient-container").remove());
                    f.css(b.cloneCSS);
                    b.scaleInternalPage && !c.isCover && f.css(b.scaleInternalPage);
                    d.prepend(f)
                }
                var g = this;
                d.click(function() {
                    g.gotoPage(a);
                    g.hideThumbnails()
                });
                return d
            }
        },
        updateThumbnail: function(a,
            b) {
            if (this.thumbnails) {
                var c = this.thumbnails[a];
                if (c) {
                    var d = this.createThumbnail(a, b);
                    d && (c.width(d.width()), c.height(d.height()), this.opts.thumbnailsSprite || (this.pdfDoc ? this.pdfRenderThumbnail(a, c, b) : c.children(":not(.wowbook-overlay)").replaceWith(d.children(":not(.wowbook-overlay)"))), c.width(d.width()), c.height(d.height()))
                }
            }
        },
        updateThumbnails: function() {
            if (this.thumbnails) {
                for (var a = this.thumbnailConfig(), b = 0, c = this.pages.length; b < c; b++) this.updateThumbnail(b, a);
                b = this.thumbnailsContainer;
                b.width() ||
                    b.width(2 * a.width);
                this.thumbnailsContainer.toggleClass("wowbook-closable", this.closable)
            } else this.createThumbnails()
        },
        _moveThumbnailsList: function(a, b) {
            var c = this.thumbnailsList.position()[this.opts.thumbnailsVertical ? "top" : "left"];
            this._setThumbnailsListPosition(c + a, b)
        },
        _setThumbnailsListPosition: function(a, b) {
            var c = this.opts.thumbnailsVertical,
                d = c ? "height" : "width",
                f = this.thumbnailsClipper[d](),
                d = -this.thumbnailsList[d]() + f;
            a < d && (a = d);
            0 < a && (a = 0);
            this.thumbnailsBackButton.toggleClass("wowbook-disabled",
                0 == a || 0 < d);
            this.thumbnailsNextButton.toggleClass("wowbook-disabled", a == d || 0 < d);
            void 0 == b && (b = e.extend({}, this.opts.thumbnailsAnimOptions));
            var g = this;
            e.isNumeric(b) && (b = {
                duration: b
            });
            b.step = c ? function(a) {
                g.thumbnailsClipper.scrollTop(a)
            } : function(a) {
                g.thumbnailsClipper.scrollLeft(a)
            };
            b.complete = function() {
                g.pdfDoc && g.updateVisibleThumbnails()
            };
            this._tb = this.thumbnailsClipper[c ? "scrollTop" : "scrollLeft"]();
            e(this).stop();
            e(this).animate({
                _tb: -a
            }, b)
        },
        updateVisibleThumbnails: function() {
            var a = this.opts.thumbnailsVertical,
                b = a ? "top" : "left",
                c = a ? "height" : "width";
            if (!this._thumbnailsPos)
                for (this._thumbnailsPos = [], a = 0; a < this.thumbnails.length; a++) this._thumbnailsPos[a] = this.thumbnails[a].position()[b];
            for (var d = this._thumbnailsPos, b = -this.thumbnailsList.position()[b], c = b + this.thumbnailsClipper[c](), e, g, a = 0; a < this.thumbnails.length; a++) void 0 == e && d[a] > b && (e = a), void 0 == g && d[a] > c && (g = a);
            e || (e = 0);
            g || (g = this.thumbnails.length - 1);
            this.pdfCancelRenderThumbnail(0, e);
            this.pdfCancelRenderThumbnail(g, this.thumbnails.length);
            for (a =
                e - 2; a <= g; a++) this.updateThumbnail(a)
        },
        showThumbnail: function(a, b) {
            if (this.thumbnails && this.thumbnailsContainer.is(":visible")) {
                void 0 == a && (a = this.currentPage);
                0 < a && this.pageIsOnTheRight(a) && a--;
                var c = this.opts.thumbnailsVertical,
                    d = c ? "top" : "left",
                    e = c ? "height" : "width",
                    g = this.thumbnails[a],
                    h = this.thumbnailsClipper,
                    c = h[e]() / 2 - g[e]() / (c ? 2 : 1),
                    d = g.offset()[d] - h.offset()[d];
                this._moveThumbnailsList(c - d, b)
            }
        },
        showThumbnails: function(a) {
            this.thumbnails && this.thumbnails.length || this.createThumbnails();
            this.thumbnailsContainer.fadeIn(void 0 !=
                a ? a : this.opts.thumbnailsAnimOptions);
            this.showThumbnail(void 0, 0)
        },
        hideThumbnails: function(a) {
            this.thumbnailsContainer.fadeOut(void 0 != a ? a : this.opts.thumbnailsAnimOptions)
        },
        toggleThumbnails: function(a) {
            e(this.thumbnailsContainer).is(":visible") ? this.hideThumbnails(a) : this.showThumbnails(a)
        },
        setPDF: function(a) {
            this.pdf = a;
            this.pdfRenderQueue = [];
            this.pdfPageRendering = !1;
            this.elem.addClass("wowbook-pdf");
            this.removePages();
            null == this.opts.pagesInMemory && (this.opts.pagesInMemory = 6);
            var b = this;
            this.pdfCSS_UNITS =
                96 / 72;
            PDFJS.getDocument(a).then(function(a) {
                b.pdfDoc = a;
                a.getPage(1).then(function(d) {
                    for (var e = 0; e < a.numPages; e++) b.insertPage("<div>", !0);
                    b.updateBook();
                    d = d.getViewport(1 * b.pdfCSS_UNITS * b.opts.pdfScale);
                    b.pdfHeight = d.height;
                    b.pdfWidth = d.width;
                    b._originalHeight = null;
                    b._originalWidth = null;
                    b.setDimensions(2 * b.pdfWidth, b.pdfHeight)
                })
            }, b.opts.onPDFLoadError || function(a) {
                e(b.pages[0] || b.elem).html(a.message);
                console && console.log && console.log(a)
            })
        },
        pdfResetPages: function() {
            this.updateBook();
            for (var a = 0; a <
                this.pages.length; a++) this.unloadPage(this.pages[a]);
            this.showPage(this.currentPage);
            this.opts.scaleToFit && this.scaleToFit();
            this.positionBookShadow()
        },
        pdfLoadPage: function(a, b) {
            var c = e("<canvas>");
            this.opts.pdfProgressiveRender && c.appendTo(this.pages[a].find(".wowbook-page-content"));
            this.pdfRenderPage(a, c[0], this.finishPageLoading)
        },
        pdfRenderPage: function(a, b, c, d, f) {
            if (this.pdfPageRendering) this.pdfQueueRenderPage(a, b, c, d, f);
            else {
                this.pdfPageRendering = !0;
                var g = this;
                this.pdfDoc.getPage(a + 1).then(function(f) {
                    d ||
                        (d = g.pdfFindScaleToFit());
                    var l = f.getViewport(d * g.pdfCSS_UNITS * g.opts.pdfScale);
                    b.height = l.height;
                    b.width = l.width;
                    var k = {
                        canvasContext: b.getContext("2d"),
                        viewport: l
                    };
                    f.render(k).then(function() {
                        c.call(g, g.pages[a], b);
                        g.pdfAnnotations(f, l, b, e(b).parent());
                        g.pdfPageRendering = !1;
                        g.pdfDequeueRenderPage()
                    }, function() {})
                })
            }
        },
        pdfAnnotations: function(a, b, c, d) {
            var f = this;
            a.getAnnotations().then(function(c) {
                b = b.clone({
                    dontFlip: !0
                });
                var h = "matrix(" + b.transform.join(",") + ")",
                    l, k, m, n;
                m = 0;
                for (n = c.length; m < n; m++)
                    if ((l =
                            c[m]) && l.hasHtml && "Link" == l.subtype && (l.url || l.dest)) {
                        var p = l.rect;
                        k = a.view;
                        p = PDFJS.Util.normalizeRect([p[0], k[3] - p[1] + k[1], p[2], k[3] - p[3] + k[1]]);
                        k = e(PDFJS.AnnotationUtils.getHtmlElement(l, a.commonObjs));
                        k.css({
                            left: p[0] + "px",
                            top: p[1] + "px",
                            position: "absolute",
                            transform: h,
                            transformOrigin: -p[0] + "px " + -p[1] + "px"
                        });
                        l.url && k.find("a").attr("target", "_blank");
                        if ("Link" === l.subtype && !l.url && l.dest) k.find("a").addClass("internalLink").on("click", l, function(a) {
                            f.pdfNavigateTo(a.data.dest);
                            return !1
                        });
                        d.append(k)
                    }
            })
        },
        pdfNavigateTo: function(a) {
            var b = this;
            b.pagesRefMap || (b.pagesRefMap = {});
            var c = function(a) {
                var e = a instanceof Object ? b.pagesRefMap[a.num + " " + a.gen + " R"] : a + 1;
                e ? b.gotoPage(e - 1) : b.pdfDoc.getPageIndex(a).then(function(e) {
                    b.pagesRefMap[a.num + " " + a.gen + " R"] = e + 1;
                    c(a)
                })
            };
            ("string" == typeof a ? this.pdfDoc.getDestination(a) : Promise.resolve(a)).then(function(a) {
                a instanceof Array && c(a[0])
            })
        },
        pdfRenderThumbnail: function(a, b, c) {
            this.thumbnailsContainer.addClass("wowbook-pdf");
            if ((c = this.pages[a]) && !c.loading && !b.pdf &&
                !b.rendering) {
                b.rendering = !0;
                var d = b.find("canvas");
                d.length || (d = e("<canvas>").appendTo(b.find(".wowbook-page-content")));
                this.opts.pdfProgressiveRender || d.css("display", "none");
                b.find(".wowbook-page").css({
                    width: b.width(),
                    height: b.height(),
                    zoom: 1,
                    transform: "scale(1)"
                });
                this.pdfRenderPage(a, d[0], function(a, c) {
                    d.css("display", "block");
                    b.rendering = !1;
                    b.pdf = !0
                }, this.thumbnailScale * this.opts.pdfScale, "thumb")
            }
        },
        pdfCancelRenderThumbnail: function(a, b) {
            for (var c = this.pdfRenderQueue, d = 0; d < c.length;) {
                var e =
                    c[d][0];
                e >= a && e <= b && "thumb" == c[d][4] ? (this.thumbnails[e].rendering = !1, c.splice(d, 1)) : d++
            }
        },
        pdfQueueRenderPage: function(a, b, c, d, e) {
            this.pdfRenderQueue.push([].slice.call(arguments))
        },
        pdfDequeueRenderPage: function() {
            var a = this.pdfRenderQueue.shift();
            a && this.pdfRenderPage.apply(this, a)
        },
        pdfFindScaleToFit: function() {
            var a = this.pageWidth,
                b = this.pageHeight,
                c = this.pdfWidth / this.pdfHeight;
            b * c > a && (b = a / c);
            return b / this.pdfHeight
        },
        createContainer: function(a) {
            a = this.container = e("<div class='wowbook-container'>");
            var b = this.opts,
                c = e.wowBook.defaults;
            a.prependTo(this.elem.parent());
            this.containerBook = e("<div class='wowbook-book-container'>").appendTo(a).append(this.elem);
            this.containerToolbar = e("<div class='wowbook-toolbar-container'>").appendTo(a);
            b.containerWidth && a.css("width", b.containerWidth);
            b.containerHeight && a.css("height", b.containerHeight);
            b.containerBackground && a.css("background", b.containerBackground);
            b.containerPadding && this.containerBook.css("padding", b.containerPadding);
            b.thumbnailsParent == c.thumbnailsParent &&
                (b.thumbnailsParent = a);
            b.tocParent == c.tocParent && (b.tocParent = a);
            b.fullscreenElement == c.fullscreenElement && (b.fullscreenElement = a);
            b.scaleToFit || (b.scaleToFit = this.containerBook);
            "window" != b.container && b.container != window || a.addClass("wowbook-container-full");
            b.toolbar && (b.toolbarParent == c.toolbarParent && (b.toolbarParent = this.containerToolbar), this._isMobile && (b.toolbarContainerPosition = "bottom"));
            this._isMobile && a.addClass("wowbook-mobile")
        },
        updateContainer: function() {
            var a = this.opts,
                b = 0;
            a.toolbarParent ==
                this.containerToolbar && ("top" == a.toolbarContainerPosition ? this.containerToolbar.insertBefore(this.containerBook) : this.containerToolbar.insertAfter(this.containerBook), b = e(this.toolbars[0]).outerHeight(!0));
            b = this.container.height() - b;
            this.containerBook.outerHeight(b);
            if (!a.conteinerHeight) {
                this.elem.css("top", this.elem.css("top"));
                var c = this;
                setTimeout(function() {
                    c.elem.css("top", "")
                }, 0)
            }
            e.wowBook.support.transform || this.elem.css("top", "auto");
            this._isMobile && this.mobileToolbar && this.updateMobileToolbar()
        },
        lightbox: function(a) {
            this._lightboxElem = e("<div class='wowbook-lightbox'>").appendTo("body");
            this._lightboxBookContainer = e("<div class='wowbook-container'>").appendTo(this._lightboxElem);
            this._lightboxOverlay = this.opts.lightboxOverlay ? e("<div class='wowbook-lightbox-overlay'>").appendTo("body") : e();
            this.opts.thumbnailsParent = this._lightboxElem;
            this.opts.tocParent = this._lightboxElem;
            this.opts.fullscreenElement = this._lightboxElem;
            this.opts.lightboxResponsive && (this.opts.scaleToFit = this._lightboxBookContainer,
                this.responsive());
            this._isMobile && this._lightboxElem.addClass("wowbook-mobile");
            this.opts.lightboxColor && this._lightboxElem.css("backgroundColor", this.opts.lightboxColor);
            this.opts.lightboxOverlayColor && this._lightboxOverlay.css("backgroundColor", this.opts.lightboxOverlayColor);
            this._lightboxElem.css({
                width: this.opts.lightboxWidth,
                height: this.opts.lightboxHeight
            });
            this.elem.appendTo(this._lightboxBookContainer);
            this.opts.toolbar && (this.opts.toolbarParent = this._lightboxElem, this._isMobile && (this.opts.toolbarLightboxPosition =
                "bottom"));
            var b = this;
            e(a).on("click.wowbook", function() {
                b.showLightbox()
            });
            e("<button class='wowbook-close'>\u2715</button>").appendTo(this._lightboxElem).on("click.wowbook", function() {
                b.hideLightbox()
            })
        },
        destroyLightbox: function(a) {
            e(this._lightboxElem).remove();
            e(this._lightboxOverlay).remove()
        },
        showLightbox: function() {
            this.thumbnailsContainer && this.thumbnailsContainer.parent()[0] != this._lightboxElem && this.thumbnailsContainer.appendTo(this._lightboxElem);
            this.elem.parent()[0] != this._lightboxBookContainer &&
                this.elem.appendTo(this._lightboxBookContainer);
            this.tocContainer && this.tocContainer.parent()[0] != this._lightboxElem && this.tocContainer.appendTo(this._lightboxElem);
            this.lightboxOn = !0;
            this._lightboxElem.show();
            this.centerLightbox();
            this._lightboxOverlay.show();
            this.positionBookShadow();
            if (this.opts.toolbarParent == this._lightboxElem) {
                var a = e(this.toolbars[0]).outerHeight(!0),
                    b = "top" == this.opts.toolbarLightboxPosition ? "top" : "bottom";
                this._lightboxBookContainer.css(b, a);
                e(this.toolbars[0]).css(b, 0)
            }
            this.opts.lightboxResponsive &&
                this.responsiveUpdater();
            this._isMobile && this.updateMobileToolbar();
            this.opts.onShowLightbox && this.opts.onShowLightbox.call(this, this.pages[this.currentPage], this.currentPage)
        },
        hideLightbox: function() {
            this.lightboxOn = !1;
            this._lightboxElem.hide();
            this._lightboxOverlay.hide();
            this.opts.onHideLightbox && this.opts.onHideLightbox.call(this, this.pages[this.currentPage], this.currentPage)
        },
        centerLightbox: function() {
            var a = e(window).width(),
                b = e(window).height();
            this._lightboxElem.css("left", (a - this._lightboxElem.outerWidth()) /
                2);
            this._lightboxElem.css("top", (b - this._lightboxElem.outerHeight()) / 2)
        },
        setStyle: function(a) {
            "string" == typeof a && (this._customCSSClass = a);
            e.isPlainObject(a) && (this._customCSSClass || (this._customCSSClass = this.generateCSSClassName()), a = this.generateCSSClass(a, this._customCSSClass), e("body").append("<style>" + a + "</style>"));
            a = this._customCSSClass;
            e(this.toolbars).addClass(a).find(".wowbook-controls").addClass(a).find(".wowbook-share-buttons").addClass(a);
            e(this.tocContainer).addClass(a);
            e(this.thumbnailsContainer).addClass(a);
            e(this.thumbnailsContainer).find(".wowbook-control").addClass(a)
        },
        generateCSSClassName: function() {
            e.wowBook.utils._cssClassCounter = (e.wowBook.utils._cssClassCounter || 0) + 1;
            return "wowbook-cs-" + e.wowBook.utils._cssClassCounter
        },
        generateCSSClass: function(a, b) {
            function c(a, b) {
                var c = [];
                c.push(a + " {");
                for (var d in b) c.push("\t" + d + " : " + b[d] + " !important;");
                c.push("}");
                return c.join("\n")
            }

            function d(a, b, d) {
                a[b] && (f.push(c(d, a[b])), delete a[b])
            }
            if (!a || !b) return "";
            a = e.extend({}, a);
            var f = [];
            a.hover && f.push(c("." +
                b + " .wowbook-close:hover", {
                    color: a.hover.color
                }));
            d(a, "hover", "." + b + " a:hover, ." + b + ".wowbook-control:hover");
            d(a, "active", "." + b + " a:active, ." + b + ".wowbook-control:active");
            d(a, "disabled", "." + b + " a.wowbook-disabled, ." + b + ".wowbook-control.wowbook-disabled");
            a.separator && (a.separator = a.separator.split(","), f.push(c("." + b + " a", {
                "border-color": a.separator[0],
                "box-shadow": "0 1px 0 " + (a.separator[1] || "transparent") + " inset"
            })), delete a.separator);
            f.push(c("." + b, a));
            console.log(f.join("\n"));
            return f.join("\n")
        },
        controllify: function(a) {
            var b = this;
            e(a.zoomIn || a.zoomin).on("click.wowbook", function() {
                b.zoomIn({});
                return !1
            });
            e(a.zoomOut || a.zoomout).on("click.wowbook", function() {
                b.zoomOut({});
                return !1
            });
            e(a.zoomReset || a.zoomreset).on("click.wowbook", function() {
                b.zoomReset({});
                return !1
            });
            e(a.next).on("click.wowbook", function() {
                b.advance();
                return !1
            });
            e(a.back).on("click.wowbook", function() {
                b.back();
                return !1
            });
            e(a.first).on("click.wowbook", function() {
                b.gotoPage(0);
                return !1
            });
            e(a.last).on("click.wowbook", function() {
                b.gotoPage(b.pages.length -
                    1);
                return !1
            });
            e(a.slideShow || a.slideshow).on("click.wowbook", function() {
                b.toggleSlideShow();
                return !1
            });
            e(a.flipSound || a.flipsound).on("click.wowbook", function() {
                b.toggleFlipSound();
                return !1
            });
            e(a.thumbnails).on("click.wowbook", function() {
                b.toggleThumbnails();
                return !1
            });
            e(a.fullscreen).on("click.wowbook", function() {
                b.toggleFullscreen();
                return !1
            });
            e(a.toc).on("click.wowbook", function() {
                b.toggleToc();
                return !1
            });
            e(a.fullscreen).length && !A && e(a.fullscreen).hide();
            var c = this.opts.downloadURL || this.opts.downloadurl ||
                this.opts.downloadUrl || this.opts.pdf;
            c && e(a.download).attr("href", c).attr("download", c);
            e(a.share).length && this.createShareControl(e(a.share));
            for (var c = "zoomIn zoomOut zoomReset next back first last slideShow flipSound thumbnails fullscreen toc currentPage pageCount".split(" "), d, f = 0, g = c.length; f < g; f++) d = c[f].toLowerCase(), this._controls[d] = e(this._controls[d]).add(a[c[f]] || a[d])
        },
        toggleControl: function(a, b) {
            (a = this._controls[a.toLowerCase()]) && e(a).toggleClass("wowbook-disabled", b)
        },
        shareControlButtons: {
            twitter: ['<a href="http://twitter.com/share" target="_blank"><i class="fa-twitter"></i></a>', {
                text: "text",
                via: "via",
                url: "url"
            }],
            googleplus: ['<a href="https://plus.google.com/share" target="_blank" ><i class="fa-google-plus"></i></a>', {
                url: "url"
            }],
            facebook: ['<a href="http://www.facebook.com/sharer/sharer.php" target="_blank" ><i class="fa-facebook"></i></a>', {
                u: "url"
            }],
            stumbleupon: ['<a href="http://www.stumbleupon.com/submit" target="_blank"><i class="fa fa-stumbleupon"></i></a>', {
                url: "url",
                title: "title"
            }],
            reddit: ['<a href="http://reddit.com/submit" target="_blank"><i class="fa fa-reddit"></i></a>', {
                url: "url",
                title: "title"
            }],
            linkedin: ['<a href="http://www.linkedin.com/shareArticle" target="_blank"><i class="fa fa-linkedin"></i></a>', {
                url: "url",
                title: "title",
                summary: "summary",
                source: "source_url"
            }]
        },
        createShareControl: function(a, b) {
            b || (b = this.opts);
            for (var c = e.extend({}, this.shareControlButtons, b.shareButtons), d, f = b.share.split(/\s*,\s*|\s+/), g = e("<div class='wowbook-share-buttons wowbook-hidden'>"), h = 0, l = f.length; h < l; h++)(d = c[f[h]]) && e(d[0]).appendTo(g).addClass("wowbook-control wowbook-share-button").data("params",
                d[1]);
            var c = e(a).addClass("wowbook-control-share").append(g),
                k = this;
            c.on("click", function(a) {
                k.toggleShareButtons(a.target)
            });
            c.on("click", ".wowbook-share-button", function() {
                var a = k.opts.shareButtonCallback;
                if (!e.isFunction(a) || !1 !== a(k, this)) {
                    var a = e.extend({}, e(this).data("params")),
                        b = e.extend(e.wowBook.defaults.shareParams, k.opts.shareParams);
                    "_current_" == b.url && (b.url = window.location.href);
                    var c;
                    for (paramName in a) c = a[paramName], void 0 != b[c] ? a[paramName] = b[c] : delete a[paramName];
                    this.search = e.param(a);
                    window.open(this.href, "_blank");
                    k.toggleShareButtons(this);
                    return !1
                }
            })
        },
        toggleShareButtons: function(a) {
            a = e(a).closest(".wowbook-control-share");
            a = a.find(".wowbook-share-buttons");
            a.hasClass("wowbook-hidden") ? (a.css("opacity", 0).removeClass("wowbook-hidden"), t(a) || a.toggleClass("wowbook-up"), a.css("opacity", 1)) : a.addClass("wowbook-hidden")
        },
        toolbarControls: {
            _default: "<a href='#'><i></i></a>",
            first: "<a title='go to first page'><i></i></a>",
            back: "<a title='go back one page'><i></i></a>",
            next: "<a title='go foward one page'><i></i></a>",
            last: "<a title='go to last page'><i></i></a>",
            zoomin: "<a title='zoom in'><i></i></a>",
            zoomout: "<a title='zoom out'><i></i></a>",
            slideshow: "<a title='start slideshow'><i></i></a>",
            flipsound: "<a title='flip sound on/off'><i></i></a>",
            fullscreen: "<a title='fullscreen on/off'><i></i></a>",
            thumbnails: "<a title='thumbnails on/off'><i></i></a>",
            toc: "<a title='table of contents on/off'><i></i></a>",
            download: "<a title='download'><i></i></a>",
            share: "<a title='share'><i></i></a>"
        },
        createToolbar: function(a, b) {
            if (a &&
                (b = e(b || this.opts.toolbarParent || this.elem.parent())) && b.length) {
                var c = e('<div class="wowbook-toolbar">'),
                    d = e('<div class="wowbook-controls">').appendTo(c);
                this.opts.toolbarIcons && c.addClass("wowbook-" + this.opts.toolbarIcons);
                a = a.split(/\s*,\s*/);
                for (var f = {}, g, h = 0; h < a.length; h += 1) g = this.createToolbarControl(a[h]), f[a[h]] = g, d.append(g);
                this.opts.removeStickyHoverStyle && (c.on("touchstart", ".wowbook-control", function() {
                    e(this).removeClass("remove-sticky-hover-style")
                }), c.on("touchend", ".wowbook-control",
                    function() {
                        e(".remove-sticky-hover-style").removeClass("remove-sticky-hover-style");
                        e(this).addClass("remove-sticky-hover-style")
                    }));
                b.prepend(c);
                this.controllify(f);
                this.toolbars.push(c[0]);
                this.setStyle(this.opts.styles || this.opts.style);
                return c
            }
        },
        destroyToolbars: function() {
            this.toolbars && e(this.toolbars).remove();
            this.toolbars = null
        },
        createToolbarControl: function(a) {
            this._avoidLoopControl || (this._avoidLoopControl = {});
            var b = a;
            if (e.isPlainObject(a)) {
                var c = a;
                a = e(this.toolbarControls._default);
                for (prop in c)
                    if (jQuery.isFunction(a[prop])) a[prop](c[prop]);
                    else a.attr(prop, c[prop])
            }
            if ("string" == typeof a)
                if ("<" == a.charAt(0)) a = e(a);
                else {
                    a = this.toolbarControls[a] || this.toolbarControls._default;
                    if (this._avoidLoopControl[a]) return "Error CreateToolbarControl in loop";
                    this._avoidLoopControl[a] = 1;
                    a = this.createToolbarControl(a);
                    this._avoidLoopControl[a] = 0;
                    a = e(a).addClass("wowbook-control-" + b)
                }
            a.addClass("wowbook-control");
            return a
        },
        setupMobileToolbar: function() {
            this.opts.toolbarLightboxPosition = "bottom";
            this.mobileToolbar = e(this.toolbars[0]);
            this.mobileToolbar.find(".wowbook-controls").css({
                position: "absolute",
                left: 0
            });
            this.createMobileToolbarToggle();
            this.slideDownMobileToolbar(0);
            this.updateMobileToolbar()
        },
        toolbarIsExpandable: function(a) {
            return 1.1 * a.height() < a.find(".wowbook-controls").height()
        },
        updateMobileToolbar: function() {
            this.mobileToolbarToggle.toggleClass("wowbook-collapsed", !this._mobileToolbarExpanded);
            this.mobileToolbarToggle.toggle(this.toolbarIsExpandable(this.mobileToolbar))
        },
        createMobileToolbarToggle: function() {
            this.mobileToolbarToggle = e("<a class='wowbook-control wowbook-control-toggle-toolbar'><i></i></a>").prependTo(this.mobileToolbar.find(".wowbook-controls"));
            var a = this;
            this.mobileToolbarToggle.on("click", function() {
                a.toogleMobileToolbar()
            });
            e(window).on("resize.wowbook", function() {
                a.mobileToolbarToggle && a.mobileToolbar && a.updateMobileToolbar()
            })
        },
        slideUpMobileToolbar: function(a) {
            var b = this.mobileToolbar.find(".wowbook-controls"),
                c = this.mobileToolbar.children().height() - this.mobileToolbar.height();
            b.css({
                bottom: -c
            }).animate({
                bottom: 0
            }, a);
            this._mobileToolbarExpanded = !0;
            this.updateMobileToolbar()
        },
        slideDownMobileToolbar: function(a) {
            var b = this.mobileToolbar.find(".wowbook-controls"),
                c = this.mobileToolbar.children().height() - this.mobileToolbar.height();
            b.animate({
                bottom: -c
            }, {
                duration: a,
                complete: function() {
                    e(this).css("bottom", "")
                }
            });
            this._mobileToolbarExpanded = !1;
            this.updateMobileToolbar()
        },
        toogleMobileToolbar: function() {
            this._mobileToolbarExpanded ? this.slideDownMobileToolbar() : this.slideUpMobileToolbar()
        },
        translate: function(a, b, c, d) {
            e.wowBook.support.transform && !1 !== d ? a.css("transform", e.wowBook.useTranslate3d ? "translate3d(" + (b || 0) + "px, " + (c || 0) + "px, 0px)" : "translate(" + (b || 0) +
                "px, " + (c || 0) + "px) ") : (void 0 !== b && a.css({
                left: b
            }), void 0 !== c && a.css({
                top: c
            }))
        }
    };
    e.wowBook.defaults = {
        width: 500,
        height: 300,
        pageWidth: void 0,
        pageHeight: void 0,
        coverWidth: void 0,
        coverHeight: void 0,
        startPage: 0,
        hardcovers: !1,
        hardPages: !1,
        closable: !0,
        centeredWhenClosed: !1,
        doublePages: ".double",
        container: !1,
        containerWidth: void 0,
        containerHeight: void 0,
        containerPadding: void 0,
        containerBackground: void 0,
        toolbarContainerPosition: "bottom",
        rtl: !1,
        responsive: !1,
        scaleToFit: "",
        maxWidth: void 0,
        maxHeight: void 0,
        onResize: null,
        responsiveHandleWidth: void 0,
        singlePage: !1,
        responsiveSinglePage: !0,
        fullscreenElement: document.documentElement,
        onFullscreenError: null,
        use3d: !0,
        perspective: 2E3,
        useTranslate3d: "mobile",
        useScale3d: !0,
        pageThickness: 0,
        pageEdgeColor: null,
        hardPageShadow: !0,
        bookShadow: !0,
        gutterShadow: !0,
        shadowThreshold: 20,
        shadows: !0,
        foldGradient: !0,
        foldGradientThreshold: 20,
        pageNumbers: !0,
        firstPageNumber: 1,
        numberedPages: !1,
        deepLinking: !0,
        updateBrowserURL: !0,
        moveToViewPort: !1,
        curl: !0,
        curlSize: 40,
        slideShow: !1,
        slideShowDelay: 1E3,
        slideShowLoop: !1,
        pauseOnHover: !0,
        touchEnabled: !0,
        mouseWheel: !1,
        handleWidth: !1,
        handleClickDuration: 300,
        turnPageDuration: 1E3,
        turnPageDurationMin: 300,
        forceBasicPage: !1,
        sections: ".wowbook-section",
        pdf: null,
        pdfScale: 1,
        pdfProgressiveRender: !1,
        onPDFLoadError: null,
        zoomLevel: 1,
        zoomMax: 2,
        zoomMin: 1,
        zoomBoundingBox: window,
        zoomStep: .25,
        zoomDuration: 200,
        zoomEasing: "linear",
        onZoom: null,
        pinchToZoom: !0,
        allowDragBrowserPageZoom: !1,
        flipSound: !0,
        flipSoundFile: ["page-flip.mp3", "page-flip.ogg"],
        flipSoundPath: "./wow_book/sound/",
        onPlayFlipSound: null,
        keyboardNavigation: {
            back: 37,
            advance: 39
        },
        clipBoundaries: !0,
        onShowPage: null,
        onHoldPage: null,
        onReleasePage: null,
        pagesInMemory: null,
        pagesToKeep: null,
        onLoadPage: null,
        onUnloadPage: null,
        lightbox: null,
        lightboxOverlay: !1,
        lightboxWidth: "100%",
        lightboxHeight: "100%",
        lightboxResponsive: !0,
        onShowLightbox: void 0,
        onHideLightbox: void 0,
        toc: void 0,
        tocParent: "body",
        tocHeader: "Table of contents",
        tocItemTemplate: void 0,
        toolbarLightboxPosition: "bottom",
        controls: {},
        downloadURL: null,
        toolbar: !1,
        toolbarParent: "body",
        toolbarIcons: "fontawesome",
        removeStickyHoverStyle: !0,
        share: "twitter, googleplus, facebook, stumbleupon, reddit, linkedin",
        shareParams: {
            url: "_current_",
            text: void 0,
            via: void 0,
            title: void 0,
            summary: void 0,
            source_url: void 0
        },
        thumbnails: !1,
        thumbnailsParent: "body",
        thumbnailScale: .2,
        thumbnailWidth: null,
        thumbnailHeight: null,
        thumbnailsPosition: null,
        thumbnailsVertical: !0,
        thumbnailsContainerWidth: null,
        thumbnailsContainerHeight: null,
        thumbnailsSprite: null,
        thumbnailsAnimOptions: {}
    };
    "undefined" != typeof QUnit && (e.wowBook.wowBook =
        r);
    window.raf = function() {
        return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function(a) {
            window.setTimeout(a, 1E3 / 60)
        }
    }();
    e.browser.ie8mode = e.browser.msie && 8 == document.documentMode;
    e.browser.ie7 = e.browser.msie && (7 == e.browser.version || 7 == document.documentMode);
    var k = e.browser.msie && 9 > e.browser.version ? 1 : 0,
        p = {
            thin: 2 - k,
            medium: 4 - k,
            thick: 6 - k
        },
        m = window.document,
        B = m.documentElement,
        A = B.requestFullscreen || B.mozRequestFullScreen || B.msRequestFullscreen ||
        B.webkitRequestFullscreen || B.webkitRequestFullScreen,
        F = m.exitFullscreen || m.mozCancelFullScreen || m.msExitFullscreen || m.webkitExitFullscreen || m.webkitCancelFullScreen,
        D = function() {
            return m.fullscreenElement || m.mozFullScreenElement || m.msFullscreenElement || m.webkitFullscreenElement || m.webkitCurrentFullScreenElement
        };
    e.wowBook.utils = {
        translate: function(a, b, c) {
            return e.wowBook.useTranslate3d ? "translate3d(" + a + "px, " + b + "px, " + (c || 0) + "px) " : "translate(" + a + "px, " + b + "px) "
        },
        isMobile: function() {
            return 480 >= e(window).width() ||
                480 >= e(window).height()
        }
    }
})(jQuery);
(function(e) {
    function r(n) {
        var k = n || window.event,
            p = [].slice.call(arguments, 1),
            m = 0,
            r = 0,
            t = 0;
        n = e.event.fix(k);
        n.type = "mousewheel";
        k.wheelDelta && (m = k.wheelDelta / 120);
        k.detail && (m = -k.detail / 3);
        t = m;
        void 0 !== k.axis && k.axis === k.HORIZONTAL_AXIS && (t = 0, r = -1 * m);
        void 0 !== k.wheelDeltaY && (t = k.wheelDeltaY / 120);
        void 0 !== k.wheelDeltaX && (r = -1 * k.wheelDeltaX / 120);
        p.unshift(n, m, r, t);
        return (e.event.dispatch || e.event.handle).apply(this, p)
    }
    var v = ["DOMMouseScroll", "mousewheel"];
    if (e.event.fixHooks)
        for (var t = v.length; t;) e.event.fixHooks[v[--t]] =
            e.event.mouseHooks;
    e.event.special.mousewheel = {
        setup: function() {
            if (this.addEventListener)
                for (var e = v.length; e;) this.addEventListener(v[--e], r, !1);
            else this.onmousewheel = r
        },
        teardown: function() {
            if (this.removeEventListener)
                for (var e = v.length; e;) this.removeEventListener(v[--e], r, !1);
            else this.onmousewheel = null
        }
    };
    e.fn.extend({
        mousewheel: function(e) {
            return e ? this.bind("mousewheel", e) : this.trigger("mousewheel")
        },
        unmousewheel: function(e) {
            return this.unbind("mousewheel", e)
        }
    })
})(jQuery);
(function(e) {
    function r(n) {
        if (n in v.style) return e.wowBook.support[n] = n;
        for (var k = t.length, p, m = n.charAt(0).toUpperCase() + n.substr(1); k--;)
            if (p = t[k] + m, p in v.style) return e.wowBook.support[n] = p
    }
    if (e.cssHooks) {
        var v = document.createElement("div"),
            t = ["O", "ms", "Webkit", "Moz"];
        r("transform");
        r("transformOrigin");
        r("boxSizing");
        r("zoom");
        e.wowBook.support.boxSizing && 8 > document.documentMode && (e.wowBook.support.boxSizing = !1);
        v = null;
        e.each(["transform", "transformOrigin"], function(n, k) {
            e.wowBook.support[k] &&
                e.wowBook.support[k] !== k && !e.cssHooks[k] && (e.cssHooks[k] = {
                    get: function(n, m, r) {
                        return e.css(n, e.wowBook.support[k])
                    },
                    set: function(n, m) {
                        n.style[e.wowBook.support[k]] = m
                    }
                })
        });
        e.wowBook.applyAlphaImageLoader = function(n) {
            var k, p, m, r, t = "",
                v = e("<div style='display:none'></div>").appendTo("body");
            p = 0;
            for (m = n.length; p < m; p++)
                if (r = n[p], v.addClass(r), k = v.css("background-image").match(/^url\("(.*)"\)$/)) t += "." + r + "{background:none; filter : progid:DXImageTransform.Microsoft.AlphaImageLoader(src='" + k[1] + "', sizingMethod='scale'); } ",
                    v.removeClass(r);
            e("body").append("<style>" + t + "</style>")
        }
    } else alert("jQuery 1.4.3+ is needed for this plugin to work")
})(jQuery);